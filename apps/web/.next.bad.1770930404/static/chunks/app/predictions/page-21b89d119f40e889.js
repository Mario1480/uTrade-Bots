(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[323],{2883:(e,i,a)=>{"use strict";a.d(i,{$P:()=>p,Al:()=>m,GC:()=>v,Vg:()=>u,hD:()=>r,mu:()=>h});var n,l,t,s,d=a(7011);null!=(null!=(n=d.env.API_URL)?n:d.env.API_BASE_URL)||d.env.NEXT_PUBLIC_API_URL;let o=null!=(s=null!=(t=null!=(l=d.env.NEXT_PUBLIC_API_URL)?l:d.env.API_URL)?t:d.env.API_BASE_URL)?s:"http://localhost:4000";class r extends Error{constructor(e,i,a){super(e),this.status=i,this.payload=a}}async function c(e,i,a){let n={"Content-Type":"application/json"};if(!["GET","HEAD","OPTIONS"].includes(e)){let e=function(e){if("undefined"==typeof document)return null;let i=document.cookie.match(new RegExp("(^|; )".concat(e,"=([^;]*)")));return i?decodeURIComponent(i[2]):null}("mm_csrf");e&&(n["x-csrf-token"]=e)}let l=await fetch("".concat(o).concat(i),{method:e,headers:n,body:a?JSON.stringify(a):void 0,credentials:"include",cache:"no-store"});if(!l.ok){let a=null;try{a=await l.json()}catch(e){}throw new r((null==a?void 0:a.error)||(null==a?void 0:a.message)||"".concat(e," ").concat(i," failed (").concat(l.status,")"),l.status,a)}return l.json()}function u(e){return c("GET",e)}function p(e,i){return c("POST",e,i)}function h(e,i){return c("PUT",e,i)}function m(e){return c("DELETE",e)}function v(e){return c("DELETE",e)}},5606:(e,i,a)=>{"use strict";a.d(i,{i4:()=>u,jH:()=>p,xf:()=>l});var n=a(3916);let l="tradeDeskPrefill",t=n.Ik({type:n.k5(["market","limit"]),price:n.ai().positive().optional()}),s=n.Ik({mode:n.k5(["percent_balance","fixed_quote"]),value:n.ai().positive()}),d=n.Ik({name:n.Yj().min(1),value:n.L5()}),o=n.Ik({rsi_14:n.ai().nullable().optional(),macd:n.Ik({line:n.ai().nullable().optional(),signal:n.ai().nullable().optional(),hist:n.ai().nullable().optional()}).nullable().optional(),bb:n.Ik({upper:n.ai().nullable().optional(),mid:n.ai().nullable().optional(),lower:n.ai().nullable().optional(),width_pct:n.ai().nullable().optional(),pos:n.ai().nullable().optional()}).nullable().optional(),vwap:n.Ik({value:n.ai().nullable().optional(),dist_pct:n.ai().nullable().optional(),mode:n.Yj().optional(),sessionStartUtcMs:n.ai().nullable().optional()}).nullable().optional(),adx:n.Ik({adx_14:n.ai().nullable().optional(),plus_di_14:n.ai().nullable().optional(),minus_di_14:n.ai().nullable().optional()}).nullable().optional(),stochrsi:n.Ik({rsi_len:n.ai().int().positive().optional(),stoch_len:n.ai().int().positive().optional(),smooth_k:n.ai().int().positive().optional(),smooth_d:n.ai().int().positive().optional(),k:n.ai().nullable().optional(),d:n.ai().nullable().optional(),value:n.ai().nullable().optional()}).nullable().optional(),volume:n.Ik({lookback:n.ai().int().positive().optional(),vol_z:n.ai().nullable().optional(),rel_vol:n.ai().nullable().optional(),vol_ema_fast:n.ai().nullable().optional(),vol_ema_slow:n.ai().nullable().optional(),vol_trend:n.ai().nullable().optional()}).nullable().optional(),fvg:n.Ik({lookback:n.ai().int().positive().optional(),fill_rule:n.k5(["overlap","mid_touch"]).optional(),open_bullish_count:n.ai().int().nonnegative().optional(),open_bearish_count:n.ai().int().nonnegative().optional(),nearest_bullish_gap:n.Ik({upper:n.ai().nullable().optional(),lower:n.ai().nullable().optional(),mid:n.ai().nullable().optional(),dist_pct:n.ai().nullable().optional(),age_bars:n.ai().nullable().optional()}).nullable().optional(),nearest_bearish_gap:n.Ik({upper:n.ai().nullable().optional(),lower:n.ai().nullable().optional(),mid:n.ai().nullable().optional(),dist_pct:n.ai().nullable().optional(),age_bars:n.ai().nullable().optional()}).nullable().optional(),last_created:n.Ik({type:n.k5(["bullish","bearish"]).nullable().optional(),age_bars:n.ai().nullable().optional()}).nullable().optional(),last_filled:n.Ik({type:n.k5(["bullish","bearish"]).nullable().optional(),age_bars:n.ai().nullable().optional()}).nullable().optional()}).nullable().optional()}).optional(),r=n.Ik({exchange:n.Yj().trim().min(1),accountId:n.Yj().trim().min(1),symbol:n.Yj().trim().min(1),marketType:n.k5(["spot","perp"]),timeframe:n.k5(["5m","15m","1h","4h","1d"]),predictionId:n.Yj().trim().min(1),tsCreated:n.Yj().datetime(),signal:n.k5(["up","down","neutral"]),confidence:n.ai().min(0).max(100),expectedMovePct:n.ai().optional(),leverage:n.ai().int().min(1).max(125).optional(),side:n.k5(["long","short"]).optional(),suggestedEntry:t.optional(),suggestedStopLoss:n.ai().positive().optional(),suggestedTakeProfit:n.ai().positive().optional(),positionSizeHint:s.optional(),tags:n.YO(n.Yj()).max(5).optional(),explanation:n.Yj().max(400).optional(),keyDrivers:n.YO(d).max(5).optional(),indicators:o});function c(e,i){let a=Number(e);if(Number.isFinite(a))return Number(a.toFixed(i))}function u(e){var i,a,n,l,t,s,d,o,u,p,h,m,v;let x=(m=e.signal,v=e.marketType,"up"===m?{side:"long"}:"down"===m?"spot"===v?{info:"Spot short not supported. Please choose a valid spot action manually."}:{side:"short"}:{}),g={exchange:e.exchange,accountId:e.accountId,symbol:e.symbol,marketType:e.marketType,timeframe:e.timeframe,predictionId:e.predictionId,tsCreated:e.tsCreated,signal:e.signal,confidence:Number.isFinite(h=e.confidence)?Math.max(0,Math.min(100,h<=1?100*h:h)):0,expectedMovePct:"number"==typeof e.expectedMovePct&&Number.isFinite(e.expectedMovePct)?Number(e.expectedMovePct.toFixed(2)):void 0,leverage:null!=(n=e.leverage)?n:void 0,side:x.side,suggestedEntry:null!=(l=e.suggestedEntry)?l:void 0,suggestedStopLoss:null!=(t=e.suggestedStopLoss)?t:void 0,suggestedTakeProfit:null!=(s=e.suggestedTakeProfit)?s:void 0,positionSizeHint:null!=(d=e.positionSizeHint)?d:void 0,tags:null!=(o=null==(i=e.tags)?void 0:i.slice(0,5))?o:void 0,explanation:null!=(u=e.explanation)?u:void 0,keyDrivers:null!=(p=null==(a=e.keyDrivers)?void 0:a.slice(0,5))?p:void 0,indicators:function(e){var i,a;if(!e)return;let n=(null==(i=e.fvg)?void 0:i.fill_rule)==="mid_touch"?"mid_touch":(null==(a=e.fvg)?void 0:a.fill_rule)==="overlap"?"overlap":void 0;return{rsi_14:c(e.rsi_14,1),macd:e.macd?{line:c(e.macd.line,4),signal:c(e.macd.signal,4),hist:c(e.macd.hist,4)}:void 0,bb:e.bb?{upper:c(e.bb.upper,4),mid:c(e.bb.mid,4),lower:c(e.bb.lower,4),width_pct:c(e.bb.width_pct,2),pos:c(e.bb.pos,3)}:void 0,vwap:e.vwap?{value:c(e.vwap.value,4),dist_pct:c(e.vwap.dist_pct,2),mode:e.vwap.mode,sessionStartUtcMs:"number"==typeof e.vwap.sessionStartUtcMs&&Number.isFinite(e.vwap.sessionStartUtcMs)?e.vwap.sessionStartUtcMs:void 0}:void 0,adx:e.adx?{adx_14:c(e.adx.adx_14,1),plus_di_14:c(e.adx.plus_di_14,1),minus_di_14:c(e.adx.minus_di_14,1)}:void 0,stochrsi:e.stochrsi?{rsi_len:c(e.stochrsi.rsi_len,0),stoch_len:c(e.stochrsi.stoch_len,0),smooth_k:c(e.stochrsi.smooth_k,0),smooth_d:c(e.stochrsi.smooth_d,0),k:c(e.stochrsi.k,1),d:c(e.stochrsi.d,1),value:c(e.stochrsi.value,1)}:void 0,volume:e.volume?{lookback:c(e.volume.lookback,0),vol_z:c(e.volume.vol_z,3),rel_vol:c(e.volume.rel_vol,3),vol_ema_fast:c(e.volume.vol_ema_fast,4),vol_ema_slow:c(e.volume.vol_ema_slow,4),vol_trend:c(e.volume.vol_trend,2)}:void 0,fvg:e.fvg?{lookback:c(e.fvg.lookback,0),fill_rule:n,open_bullish_count:c(e.fvg.open_bullish_count,0),open_bearish_count:c(e.fvg.open_bearish_count,0),nearest_bullish_gap:e.fvg.nearest_bullish_gap?{upper:c(e.fvg.nearest_bullish_gap.upper,4),lower:c(e.fvg.nearest_bullish_gap.lower,4),mid:c(e.fvg.nearest_bullish_gap.mid,4),dist_pct:c(e.fvg.nearest_bullish_gap.dist_pct,2),age_bars:c(e.fvg.nearest_bullish_gap.age_bars,0)}:void 0,nearest_bearish_gap:e.fvg.nearest_bearish_gap?{upper:c(e.fvg.nearest_bearish_gap.upper,4),lower:c(e.fvg.nearest_bearish_gap.lower,4),mid:c(e.fvg.nearest_bearish_gap.mid,4),dist_pct:c(e.fvg.nearest_bearish_gap.dist_pct,2),age_bars:c(e.fvg.nearest_bearish_gap.age_bars,0)}:void 0,last_created:e.fvg.last_created?{type:"bullish"===e.fvg.last_created.type||"bearish"===e.fvg.last_created.type?e.fvg.last_created.type:void 0,age_bars:c(e.fvg.last_created.age_bars,0)}:void 0,last_filled:e.fvg.last_filled?{type:"bullish"===e.fvg.last_filled.type||"bearish"===e.fvg.last_filled.type?e.fvg.last_filled.type:void 0,age_bars:c(e.fvg.last_filled.age_bars,0)}:void 0}:void 0}}(e.indicators)};return{payload:r.parse(g),info:x.info}}function p(e){let i=r.safeParse(e);return i.success?i.data:null}},7199:(e,i,a)=>{Promise.resolve().then(a.bind(a,9891))},9891:(e,i,a)=>{"use strict";a.r(i),a.d(i,{default:()=>L});var n=a(4568),l=a(9664),t=a.n(l),s=a(7541),d=a(7620),o=a(2883),r=a(5606);let c=/signal:(up|down|neutral)->(up|down|neutral)/i,u=/confidence_delta:([+-]?\d+(?:\.\d+)?)/i,p={scheduled_due:"Scheduled refresh",tags_changed:"Tags changed",trend_rank_bucket_changed:"Trend regime changed",vol_rank_bucket_changed:"Volatility regime changed",atr_rank_bucket_changed:"ATR regime changed",manual_create:"Manual create",bootstrap:"Bootstrap import"};function h(e){let i=e.trim();if(!i)return"";let a=p[i];return a||i.replace(/_/g," ").replace(/\s+/g," ").trim()}function m(e){let i="string"==typeof e&&e.trim().length>0?e.trim():null;if(!i)return{raw:null,kind:"unknown",label:"Unknown",shortReason:"n/a",lastChangeType:null,signalFlip:null};let a=i.match(c),n=a?{from:a[1].toLowerCase(),to:a[2].toLowerCase()}:null,l=null;i.startsWith("manual")?l="manual":i.startsWith("scheduled")?l="scheduled_checkpoint":n?l="signal_flip":i.includes("confidence_delta:")?l="confidence_jump":(i.includes("atr_rank_bucket")||i.includes("trend_rank_bucket")||i.includes("tags:")||i.includes("trigger:"))&&(l="regime_change");let t="unknown";i.startsWith("manual")?t="manual":i.startsWith("scheduled")||i.startsWith("bootstrap")?t="scheduled":(i.startsWith("trigger:")||n||i.includes("confidence_delta:")||i.includes("tags:"))&&(t="triggered");let s=function(e,i){let a=e.split(",").map(e=>e.trim()).filter(Boolean);if(0===a.length)return"n/a";let n=[];for(let e of a){if(e.startsWith("signal:")){i?n.push("Signal ".concat(i.from.toUpperCase(),"->").concat(i.to.toUpperCase())):n.push("Signal changed");continue}if(e.startsWith("confidence_delta:")){var l;n.push(null!=(l=function(e){let i=e.match(u);if(!i)return null;let a=Number(i[1]);if(!Number.isFinite(a))return"Confidence changed";let n=a>0?"+":"";return"Confidence ".concat(n).concat(a.toFixed(1))}(e))?l:"Confidence changed");continue}if(e.startsWith("trigger:")){let i=e.slice(8).trim();n.push("Trigger: ".concat(h(i)||"condition met"));continue}n.push(h(e))}return n.filter(Boolean).join(" • ")}(i,n),d=s.length>80?"".concat(s.slice(0,77),"..."):s,o="scheduled"===t?"Scheduled":"triggered"===t?"Triggered":"manual"===t?"Manual":"Unknown";return{raw:i,kind:t,label:o,shortReason:d,lastChangeType:l,signalFlip:n}}function v(e,i){if(!e)return"n/a";let a=new Date(e).getTime();if(!Number.isFinite(a))return"n/a";let n=Math.max(0,Math.floor((i-a)/1e3));if(n<10)return"just now";if(n<60)return"".concat(n,"s ago");let l=Math.floor(n/60);if(l<60)return"".concat(l,"m ago");let t=Math.floor(l/60);if(t<24)return"".concat(t,"h ago");let s=Math.floor(t/24);return s<7?"".concat(s,"d ago"):new Date(a).toLocaleDateString()}function x(e,i,a){if(!e)return!1;let n=new Date(e).getTime();return!!Number.isFinite(n)&&i-n<=a}let g=["5m","15m","1h","4h","1d"];function f(e){let i=Math.max(0,Math.floor(e/1e3)),a=Math.floor(i/3600),n=Math.floor(i%3600/60),l=i%60;return a>0?"".concat(a,"h ").concat(n,"m"):n>0?"".concat(n,"m ").concat(l,"s"):"".concat(l,"s")}function j(e,i){var a;if(!e.autoScheduleEnabled)return"disabled";let n=new Date(e.tsCreated).getTime();if(!Number.isFinite(n))return"unknown";let l=n+("5m"===(a=e.timeframe)?3e5:"15m"===a?9e5:"1h"===a?36e5:"4h"===a?144e5:864e5)-i;return l<=0?"due now":"in ".concat(f(l))}function b(e){return e instanceof o.hD?"".concat(e.message," (HTTP ").concat(e.status,")"):e&&"object"==typeof e&&"message"in e?String(e.message):String(e)}function y(e){let i=Math.max(0,Math.min(100,e<=1?100*e:e));return"".concat(i.toFixed(1),"%")}function N(e){return Math.max(0,Math.min(100,e<=1?100*e:e))}function _(e){return"up"===e?{borderColor:"#10b981",color:"#10b981"}:"down"===e?{borderColor:"#ef4444",color:"#ef4444"}:{borderColor:"#94a3b8",color:"#94a3b8"}}function S(e,i){return"closed"!==e?"pending":i||"closed"}function C(e){let i=Number(e);return Number.isFinite(i)?i:null}function w(e){let i=A(e),a="up"===i.signal||"down"===i.signal||"neutral"===i.signal?i.signal:null,n=C(i.expectedMovePct),l=C(i.confidence);return a&&null!==n&&null!==l?{signal:a,expectedMovePct:Math.max(0,Math.min(25,Math.abs(n))),confidence:Math.max(0,Math.min(1,l<=1?l:l/100))}:null}function P(e,i){return"local"===i&&e.localPrediction?e.localPrediction.signal:"ai"===i&&e.aiPrediction?e.aiPrediction.signal:e.signal}function k(e,i){return"local"===i&&e.localPrediction?e.localPrediction.confidence:"ai"===i&&e.aiPrediction?e.aiPrediction.confidence:e.confidence}function I(e,i){return"local"===i&&e.localPrediction?e.localPrediction.expectedMovePct:"ai"===i&&e.aiPrediction?e.aiPrediction.expectedMovePct:e.expectedMovePct}function R(e){return"local_only"===e?"local only":"ai_only"===e?"ai only":"both"}function T(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,a=C(e);return null===a?"n/a":a.toFixed(i)}function A(e){return!e||"object"!=typeof e||Array.isArray(e)?{}:e}function M(e){return e?"".concat(e.from.toUpperCase(),"->").concat(e.to.toUpperCase()):"FLIP"}function F(e){return"manual"!==e.parsedReason.kind?{label:e.parsedReason.label,shortReason:e.parsedReason.shortReason,rawReason:e.parsedReason.raw}:e.autoEnabled?{label:"Manual",shortReason:"manual (waiting for first auto refresh)",rawReason:"manual_waiting_first_auto_refresh"}:{label:"Manual",shortReason:"manual (one-off)",rawReason:"manual_one_off"}}function L(){var e,i,a,l,c,u,p,h,L,D,E,z,B,U,H,V,W,O,Y;let G=(0,s.useRouter)(),[q,X]=(0,d.useState)([]),[$,J]=(0,d.useState)(!0),[K,Q]=(0,d.useState)(!1),[Z,ee]=(0,d.useState)(null),[ei,ea]=(0,d.useState)(null),[en,el]=(0,d.useState)(null),[et,es]=(0,d.useState)(null),[ed,eo]=(0,d.useState)(null),[er,ec]=(0,d.useState)(null),[eu,ep]=(0,d.useState)(null),[eh,em]=(0,d.useState)(!0),[ev,ex]=(0,d.useState)([]),[eg,ef]=(0,d.useState)(!0),[ej,eb]=(0,d.useState)(null),[ey,eN]=(0,d.useState)("all"),[e_,eS]=(0,d.useState)("30"),[eC,ew]=(0,d.useState)(!1),[eP,ek]=(0,d.useState)(!1),[eI,eR]=(0,d.useState)([]),[eT,eA]=(0,d.useState)(""),[eM,eF]=(0,d.useState)([]),[eL,eD]=(0,d.useState)(!1),[eE,ez]=(0,d.useState)(null),[eB,eU]=(0,d.useState)(""),[eH,eV]=(0,d.useState)("all"),[eW,eO]=(0,d.useState)("all"),[eY,eG]=(0,d.useState)("local"),[eq,eX]=(0,d.useState)("newest"),[e$,eJ]=(0,d.useState)("BTCUSDT"),[eK,eQ]=(0,d.useState)("perp"),[eZ,e0]=(0,d.useState)("15m"),[e1,e4]=(0,d.useState)("either"),[e2,e6]=(0,d.useState)("both"),[e8,e5]=(0,d.useState)("60"),[e3,e9]=(0,d.useState)("10"),[e7,ie]=(0,d.useState)(!0),[ii,ia]=(0,d.useState)(()=>Date.now()),[il,it]=(0,d.useState)(null),[is,id]=(0,d.useState)({}),[io,ir]=(0,d.useState)(null),[ic,iu]=(0,d.useState)(null),[ip,ih]=(0,d.useState)({}),[im,iv]=(0,d.useState)(null),[ix,ig]=(0,d.useState)({}),[ij,ib]=(0,d.useState)({});async function iy(){J(!0),ee(null);try{let e=await (0,o.Vg)("/api/predictions?limit=100");X(Array.isArray(e.items)?e.items.map(e=>({...e,localPrediction:w(e.localPrediction),aiPrediction:w(e.aiPrediction)})):[])}catch(e){ee(b(e))}finally{J(!1)}}async function iN(){ef(!0);try{let e=await (0,o.Vg)("/api/predictions/running");ex(Array.isArray(e.items)?e.items:[])}catch(e){ex([])}finally{ef(!1)}}async function i_(){try{let e=await (0,o.Vg)("/api/predictions/quality");eo(e)}catch(e){eo(null)}}async function iS(){try{let e=await (0,o.Vg)("/api/predictions/metrics?bins=10");ec(e)}catch(e){ec(null)}}async function iC(){em(!0);try{let e=await (0,o.Vg)("/api/predictions/activity");ep(e)}catch(e){ep(null)}finally{em(!1)}}async function iw(){try{let e=await (0,o.Vg)("/exchange-accounts"),i=Array.isArray(e.items)?e.items:[];if(eR(i),0===i.length)return void eA("");eA(e=>e&&i.some(i=>i.id===e)?e:i[0].id)}catch(e){eR([]),eA("")}}async function iP(e){eD(!0),ez(null);try{let a=await (0,o.Vg)("/api/symbols?exchangeAccountId=".concat(encodeURIComponent(e))),n=Array.isArray(a.items)?a.items:[];if(eF(n),n.length>0&&!n.some(e=>e.symbol===e$)){var i;let e=null!=(i=n.find(e=>e.tradable))?i:n[0];(null==e?void 0:e.symbol)&&eJ(e.symbol)}}catch(e){eF([]),ez(b(e))}finally{eD(!1)}}(0,d.useEffect)(()=>{iy(),iN(),i_(),iS(),iC(),iw()},[]),(0,d.useEffect)(()=>{if(!eT)return void eF([]);iP(eT)},[eT]),(0,d.useEffect)(()=>{let e=setInterval(()=>ia(Date.now()),1e3);return()=>clearInterval(e)},[]);let ik=(0,d.useMemo)(()=>{let e=eB.trim().toUpperCase(),i=q.filter(i=>(!e||!!i.symbol.toUpperCase().includes(e))&&("all"===eH||P(i,eY)===eH)&&("all"===eW||i.timeframe===eW));return i.sort((e,i)=>"confidence"===eq?(1>=k(i,eY)?100*k(i,eY):k(i,eY))-(1>=k(e,eY)?100*k(e,eY):k(e,eY)):"move"===eq?Math.abs(I(i,eY))-Math.abs(I(e,eY)):new Date(i.tsCreated).getTime()-new Date(e.tsCreated).getTime()),i},[eH,eB,eW,q,eY,eq]),iI=(0,d.useMemo)(()=>"all"===ey?ev:ev.filter(e=>"paused"===ey?e.paused:!e.paused),[ev,ey]);async function iR(e){ea(null),es(null),el(e);try{var i,a;let n=await (0,o.Vg)("/api/predictions/".concat(e)),l=q.find(i=>i.id===e),t=null!=(i=null==l?void 0:l.localPrediction)?i:w(A(n.featureSnapshot).localPrediction),s=null!=(a=null==l?void 0:l.aiPrediction)?a:w(A(n.featureSnapshot).aiPrediction);if(!n.accountId)throw Error("No exchange account available for this prediction.");let d="ai"===eY&&s?{...n,signal:s.signal,confidence:s.confidence,expectedMovePct:s.expectedMovePct}:"local"===eY&&t?{...n,signal:t.signal,confidence:t.confidence,expectedMovePct:t.expectedMovePct}:n,c=(0,r.i4)(d);sessionStorage.setItem(r.xf,JSON.stringify(c.payload)),c.info&&es(c.info);let u=new URLSearchParams({prefill:"1",exchangeAccountId:c.payload.accountId});G.push("/trading-desk?".concat(u.toString()))}catch(e){ea(b(e))}finally{el(null)}}async function iT(e){if(iu(null),il===e)return void it(null);if(it(e),!is[e]){ir(e);try{let i=await (0,o.Vg)("/api/predictions/".concat(e));id(a=>({...a,[e]:i}))}catch(e){iu(b(e))}finally{ir(null)}}}async function iA(e){if(!ip[e]){iv(e),ig(i=>({...i,[e]:null}));try{let i=await (0,o.Vg)("/api/predictions/events?stateId=".concat(encodeURIComponent(e),"&limit=10"));ih(a=>({...a,[e]:Array.isArray(i.items)?i.items:[]}))}catch(i){ig(i=>({...i,[e]:"Unable to load events."}))}finally{iv(null)}}}async function iM(){ea(null),es(null);let e=e$.trim().toUpperCase(),i=Number(e8),a=Number(e3);if(!eT)return void ea("Please select an exchange account first.");if(!e)return void ea("Please select a pair.");if(!Number.isFinite(i)||i<0||i>100)return void ea("Confidence target must be between 0 and 100.");if("perp"===eK&&(!Number.isFinite(a)||a<1||a>125))return void ea("Leverage must be between 1 and 125 for futures.");Q(!0);try{let n=await (0,o.$P)("/api/predictions/generate-auto",{exchangeAccountId:eT,symbol:e,marketType:eK,timeframe:eZ,directionPreference:e1,signalMode:e2,confidenceTargetPct:i,leverage:"perp"===eK?Math.trunc(a):void 0,autoSchedule:e7}),l="local_only"===n.signalMode?"Local only":"ai_only"===n.signalMode?"AI only":"Local + AI";es("Prediction created for ".concat(e," (").concat(eZ,") with signal ").concat(n.prediction.signal," ")+"and confidence ".concat(y(n.prediction.confidence),". ")+"Mode: ".concat(l,", active source: ").concat(n.signalSource.toUpperCase(),".")+(e7?" Auto mode is enabled (".concat(eZ," cadence)."):" Auto mode is disabled.")),await Promise.all([iy(),iN(),i_(),iS(),iC()])}catch(e){ea(b(e))}finally{Q(!1)}}async function iF(e){ea(null),es(null),eb(e.id);try{let i=!e.paused,a=await (0,o.$P)("/api/predictions/".concat(e.id,"/pause"),{paused:i});es(a.paused?"Prediction paused (".concat(a.updatedCount," template rows updated)."):"Prediction resumed (".concat(a.updatedCount," template rows updated).")),await Promise.all([iy(),iN(),i_(),iS(),iC()])}catch(e){ea(b(e))}finally{eb(null)}}async function iL(e){if(window.confirm("Delete this auto-prediction schedule and related template rows? This cannot be undone.")){ea(null),es(null),eb(e);try{let i=await (0,o.$P)("/api/predictions/".concat(e,"/delete-schedule"),{});es("Auto prediction deleted (".concat(i.deletedCount," rows removed).")),await Promise.all([iy(),iN(),i_(),iS(),iC()])}catch(e){ea(b(e))}finally{eb(null)}}}async function iD(){let e=Number(e_);if(!Number.isFinite(e)||e<1||e>3650)return void ea("Please enter a valid day count between 1 and 3650.");if(window.confirm("Delete predictions older than ".concat(Math.trunc(e)," day(s)? Active auto templates will be kept."))){ea(null),es(null),ew(!0);try{let i=await (0,o.$P)("/api/predictions/clear-old",{olderThanDays:Math.trunc(e),keepRunningTemplates:!0});es("Cleared ".concat(i.deletedCount," old prediction(s) older than ").concat(i.olderThanDays," day(s). ")+"Preserved running templates: ".concat(i.preservedCount,".")),await Promise.all([iy(),iN(),i_(),iS(),iC()])}catch(e){ea(b(e))}finally{ew(!1)}}}async function iE(){if(0===ik.length)return void ea("No filtered predictions to delete.");if(window.confirm("Delete ".concat(ik.length," currently listed prediction(s)?"))){ea(null),es(null),ek(!0);try{let e=await (0,o.$P)("/api/predictions/delete-many",{ids:ik.map(e=>e.id)});es("Deleted ".concat(e.deletedCount," listed prediction(s).")),await Promise.all([iy(),iN(),i_(),iS(),iC()])}catch(e){ea(b(e))}finally{ek(!1)}}}function iz(e){var i,a,l,t,s,d,o,r,c,u,p,h,g,f,j,b,N,_,S,P,k,I,L,D,E,z,B,U,H,V,W,O,Y,G,q,X,$,J,K,Q;let Z=e.id,ee=is[Z],ei=null!=(B=null==ee?void 0:ee.indicators)?B:null,ea=A(null==ee?void 0:ee.featureSnapshot),en=null!=(U=e.localPrediction)?U:w(ea.localPrediction),el=null!=(H=e.aiPrediction)?H:w(ea.aiPrediction),et="ai"===eY&&el?el.signal:"local"===eY&&en?en.signal:e.signal,es="ai"===eY&&el?el.confidence:"local"===eY&&en?en.confidence:e.confidence,ed="ai"===eY&&el?el.expectedMovePct:"local"===eY&&en?en.expectedMovePct:e.expectedMovePct,eo=io===Z,er=!!((null==ei?void 0:ei.dataGap)||(null==ee||null==(i=ee.riskFlags)?void 0:i.dataGap)),ec=null!=(V=e.lastUpdatedAt)?V:e.tsCreated,eu=m(null!=(W=e.lastChangeReason)?W:null),ep=F({parsedReason:eu,autoEnabled:!!e.autoScheduleEnabled}),eh=null!=(Y=null!=(O=ip[Z])?O:null==ee?void 0:ee.events)?Y:[],em=!!ij[Z],ev=im===Z,ex=null!=(G=ix[Z])?G:null,eg=null!=(q=null==ee?void 0:ee.realized)?q:null,ef=A(null==eg?void 0:eg.errorMetrics),ej="number"==typeof e.realizedReturnPct?e.realizedReturnPct:C(null==eg?void 0:eg.realizedReturnPct),eb=null!=(X=e.realizedEvaluatedAt)?X:"string"==typeof(null==eg?void 0:eg.evaluatedAt)?eg.evaluatedAt:null,ey="boolean"==typeof e.realizedHit?e.realizedHit:function(e){if("boolean"==typeof e)return e;if("number"==typeof e&&Number.isFinite(e))return e>0;if("string"==typeof e){let i=e.trim().toLowerCase();if("true"===i||"1"===i||"hit"===i)return!0;if("false"===i||"0"===i||"miss"===i)return!1}return null}(ef.hit),eN="number"==typeof e.realizedAbsError?e.realizedAbsError:C(ef.absError),e_="number"==typeof e.realizedSqError?e.realizedSqError:C(ef.sqError),eS="triggered"===eu.kind?"predictionReasonBadgeTrigger":"scheduled"===eu.kind?"predictionReasonBadgeScheduled":"manual"===eu.kind?"predictionReasonBadgeManual":"predictionReasonBadgeUnknown";return eo&&!ee?(0,n.jsx)("div",{style:{color:"var(--muted)",fontSize:13},children:"Loading prediction details..."}):(0,n.jsxs)("div",{className:"predictionDetailStack",children:[(0,n.jsxs)("div",{className:"card predictionDetailPanel",children:[(0,n.jsx)("div",{className:"predictionDetailHeader",children:(0,n.jsx)("strong",{children:"Prediction Context"})}),(0,n.jsxs)("div",{className:"predictionContextRow",children:[(0,n.jsx)("span",{className:"badge ".concat(eS),children:ep.label}),eu.signalFlip?(0,n.jsxs)("span",{className:"badge predictionFlipBadge",children:["FLIP ",M(eu.signalFlip)]}):null,(0,n.jsxs)("span",{className:"predictionUpdateMeta ".concat(x(ec,ii,12e4)?"predictionUpdateMetaFresh":""),title:ec?new Date(ec).toLocaleString():"n/a",children:["Last updated ",v(ec,ii)]})]}),(0,n.jsxs)("div",{className:"predictionContextReason",children:["Reason: ",ep.shortReason]}),(0,n.jsxs)("div",{className:"predictionContextReason",children:["Signal source: ","ai"===eY?"AI":"Local","ai"!==eY||el?"":" (AI value unavailable, using local)"]}),(0,n.jsxs)("div",{className:"predictionContextReason",children:["Signal mode: ",R(e.signalMode)]}),er?(0,n.jsx)("span",{className:"predictionDetailWarning",children:"Data gap detected"}):null,(0,n.jsxs)("div",{className:"predictionIndicatorGrid",children:[(0,n.jsxs)("div",{className:"card predictionIndicatorCard",children:[(0,n.jsx)("div",{className:"predictionIndicatorTitle",children:"Selected signal"}),(0,n.jsx)("div",{className:"predictionIndicatorValue",children:et}),(0,n.jsxs)("div",{className:"predictionIndicatorMeta",children:["conf ",y(es)," \xb7 move ",ed.toFixed(2),"%"]})]}),(0,n.jsxs)("div",{className:"card predictionIndicatorCard",children:[(0,n.jsx)("div",{className:"predictionIndicatorTitle",children:"Local vs AI signal"}),(0,n.jsxs)("div",{className:"predictionIndicatorValue",children:[null!=($=null==en?void 0:en.signal)?$:e.signal," / ",null!=(J=null==el?void 0:el.signal)?J:"n/a"]}),(0,n.jsxs)("div",{className:"predictionIndicatorMeta",children:["local ",y(null!=(K=null==en?void 0:en.confidence)?K:e.confidence)," \xb7 ai ",el?y(el.confidence):"n/a"]})]}),(0,n.jsxs)("div",{className:"card predictionIndicatorCard",children:[(0,n.jsx)("div",{className:"predictionIndicatorTitle",children:"Evaluated"}),(0,n.jsx)("div",{className:"predictionIndicatorValue",children:eb?"yes":"no"}),(0,n.jsx)("div",{className:"predictionIndicatorMeta",children:eb?"at ".concat(new Date(eb).toLocaleString()):"horizon not elapsed yet"})]}),(0,n.jsxs)("div",{className:"card predictionIndicatorCard",children:[(0,n.jsx)("div",{className:"predictionIndicatorTitle",children:"Realized return %"}),(0,n.jsx)("div",{className:"predictionIndicatorValue",children:T(ej,4)})]}),(0,n.jsxs)("div",{className:"card predictionIndicatorCard",children:[(0,n.jsx)("div",{className:"predictionIndicatorTitle",children:"Directional hit"}),(0,n.jsx)("div",{className:"predictionIndicatorValue",children:null===ey?"n/a":ey?"hit":"miss"})]}),(0,n.jsxs)("div",{className:"card predictionIndicatorCard",children:[(0,n.jsx)("div",{className:"predictionIndicatorTitle",children:"Abs error"}),(0,n.jsx)("div",{className:"predictionIndicatorValue",children:T(eN,4)})]}),(0,n.jsxs)("div",{className:"card predictionIndicatorCard",children:[(0,n.jsx)("div",{className:"predictionIndicatorTitle",children:"Sq error"}),(0,n.jsx)("div",{className:"predictionIndicatorValue",children:T(e_,4)})]}),ei?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"card predictionIndicatorCard",children:[(0,n.jsx)("div",{className:"predictionIndicatorTitle",children:"RSI (14)"}),(0,n.jsx)("div",{className:"predictionIndicatorValue",children:T(ei.rsi_14,2)})]}),(0,n.jsxs)("div",{className:"card predictionIndicatorCard",children:[(0,n.jsx)("div",{className:"predictionIndicatorTitle",children:"MACD (line / signal / hist)"}),(0,n.jsxs)("div",{className:"predictionIndicatorValue",children:[T(null==(a=ei.macd)?void 0:a.line,4)," / ",T(null==(l=ei.macd)?void 0:l.signal,4)," / ",T(null==(t=ei.macd)?void 0:t.hist,4)]})]}),(0,n.jsxs)("div",{className:"card predictionIndicatorCard",children:[(0,n.jsx)("div",{className:"predictionIndicatorTitle",children:"Bollinger (width% / pos)"}),(0,n.jsxs)("div",{className:"predictionIndicatorValue",children:[T(null==(s=ei.bb)?void 0:s.width_pct,2)," / ",T(null==(d=ei.bb)?void 0:d.pos,3)]})]}),(0,n.jsxs)("div",{className:"card predictionIndicatorCard",children:[(0,n.jsx)("div",{className:"predictionIndicatorTitle",children:"VWAP (value / dist%)"}),(0,n.jsxs)("div",{className:"predictionIndicatorValue",children:[T(null==(o=ei.vwap)?void 0:o.value,2)," / ",T(null==(r=ei.vwap)?void 0:r.dist_pct,2)]}),(0,n.jsxs)("div",{className:"predictionIndicatorMeta",children:["mode: ",null!=(Q=null==(c=ei.vwap)?void 0:c.mode)?Q:"n/a"]})]}),(0,n.jsxs)("div",{className:"card predictionIndicatorCard",children:[(0,n.jsx)("div",{className:"predictionIndicatorTitle",children:"ADX (ADX / +DI / -DI)"}),(0,n.jsxs)("div",{className:"predictionIndicatorValue",children:[T(null==(u=ei.adx)?void 0:u.adx_14,2)," / ",T(null==(p=ei.adx)?void 0:p.plus_di_14,2)," / ",T(null==(h=ei.adx)?void 0:h.minus_di_14,2)]})]}),(0,n.jsxs)("div",{className:"card predictionIndicatorCard",children:[(0,n.jsx)("div",{className:"predictionIndicatorTitle",children:"StochRSI (%K / %D / value)"}),(0,n.jsxs)("div",{className:"predictionIndicatorValue",children:[T(null==(g=ei.stochrsi)?void 0:g.k,1)," / ",T(null==(f=ei.stochrsi)?void 0:f.d,1)," / ",T(null==(j=ei.stochrsi)?void 0:j.value,1)]})]}),(0,n.jsxs)("div",{className:"card predictionIndicatorCard",children:[(0,n.jsx)("div",{className:"predictionIndicatorTitle",children:"Volume (z / rel / trend%)"}),(0,n.jsxs)("div",{className:"predictionIndicatorValue",children:[T(null==(b=ei.volume)?void 0:b.vol_z,3)," / ",T(null==(N=ei.volume)?void 0:N.rel_vol,3)," / ",T(null==(_=ei.volume)?void 0:_.vol_trend,2)]}),(0,n.jsxs)("div",{className:"predictionIndicatorMeta",children:["EMA fast/slow: ",T(null==(S=ei.volume)?void 0:S.vol_ema_fast,2)," / ",T(null==(P=ei.volume)?void 0:P.vol_ema_slow,2)]})]}),(0,n.jsxs)("div",{className:"card predictionIndicatorCard",children:[(0,n.jsx)("div",{className:"predictionIndicatorTitle",children:"FVG (open bull / bear)"}),(0,n.jsxs)("div",{className:"predictionIndicatorValue",children:[T(null==(k=ei.fvg)?void 0:k.open_bullish_count,0)," / ",T(null==(I=ei.fvg)?void 0:I.open_bearish_count,0)]}),(0,n.jsxs)("div",{className:"predictionIndicatorMeta",children:["bull dist: ",T(null==(D=ei.fvg)||null==(L=D.nearest_bullish_gap)?void 0:L.dist_pct,2),"% \xb7 bear dist: ",T(null==(z=ei.fvg)||null==(E=z.nearest_bearish_gap)?void 0:E.dist_pct,2),"%"]})]}),(0,n.jsxs)("div",{className:"card predictionIndicatorCard",children:[(0,n.jsx)("div",{className:"predictionIndicatorTitle",children:"ATR %"}),(0,n.jsx)("div",{className:"predictionIndicatorValue",children:T(ei.atr_pct,4)})]})]}):(0,n.jsxs)("div",{className:"card predictionIndicatorCard",children:[(0,n.jsx)("div",{className:"predictionIndicatorTitle",children:"Indicators"}),(0,n.jsx)("div",{className:"predictionIndicatorValue",children:"n/a"}),(0,n.jsx)("div",{className:"predictionIndicatorMeta",children:"No indicator data for this prediction."})]})]})]}),(0,n.jsxs)("div",{className:"card predictionDetailPanel",children:[(0,n.jsxs)("div",{className:"predictionDetailHeader",children:[(0,n.jsx)("strong",{children:"Recent Changes"}),(0,n.jsxs)("button",{className:"btn predictionMiniBtn",type:"button",onClick:()=>(function(e){let i=!ij[e];ib(a=>({...a,[e]:i})),i&&iA(e)})(Z),children:[em?"Hide":"Show"," (",eh.length,")"]})]}),em?ev?(0,n.jsx)("div",{style:{color:"var(--muted)",marginTop:8},children:"Loading event log..."}):ex?(0,n.jsx)("div",{style:{color:"var(--muted)",marginTop:8},children:ex}):0===eh.length?(0,n.jsx)("div",{style:{color:"var(--muted)",marginTop:8},children:"No recent changes recorded."}):(0,n.jsx)("div",{className:"predictionEventList",children:eh.map(e=>{var i;return(0,n.jsxs)("div",{className:"predictionEventItem",children:[(0,n.jsxs)("div",{className:"predictionEventHeader",children:[(0,n.jsx)("span",{className:"badge",children:e.changeType}),(0,n.jsx)("span",{className:"predictionEventTimestamp",title:e.tsCreated?new Date(e.tsCreated).toLocaleString():"n/a",children:v(e.tsCreated,ii)})]}),(0,n.jsx)("div",{className:"predictionEventReason",children:null!=(i=e.reason)?i:"n/a"}),(0,n.jsx)("div",{className:"predictionEventDelta",children:function(e){if(!e||"object"!=typeof e)return"No delta data";let i=[],a="string"==typeof e.signal?e.signal:null;a&&i.push("signal ".concat(a));let n=C(e.confidenceDelta);if(null!==n){let e=n>=0?"+":"";i.push("confidence ".concat(e).concat(n.toFixed(2)))}let l=Array.isArray(e.tagsAdded)?e.tagsAdded.map(e=>String(e)).filter(Boolean):[];l.length>0&&i.push("+".concat(l.join(", ")));let t=Array.isArray(e.tagsRemoved)?e.tagsRemoved.map(e=>String(e)).filter(Boolean):[];return(t.length>0&&i.push("-".concat(t.join(", "))),0===i.length)?"No delta data":i.join(" | ")}(e.delta)})]},e.id)})}):(0,n.jsx)("div",{style:{color:"var(--muted)",marginTop:8},children:"Expand to see the last refresh events."})]})]})}let iB=F({parsedReason:m(null!=(h=null==eu?void 0:eu.user.latestStateReason)?h:null),autoEnabled:(null!=(L=null==eu?void 0:eu.user.activeSchedules)?L:0)>0}),iU=null!=(D=null==eu?void 0:eu.user.activeSchedules)?D:0,iH=Number.isFinite(Number(null==eu?void 0:eu.user.staleAfterMs))?Number(null==eu?void 0:eu.user.staleAfterMs):9e5,iV=null!=(E=null==eu?void 0:eu.user.latestSignalCalculatedAt)?E:null,iW=iU>0&&!x(iV,ii,Math.max(iH,6e4)),iO=eu?eu.scheduler.enabled?eu.scheduler.running?"running":"idle":"disabled":"unknown",iY=eu&&eu.scheduler.enabled?iW?"predictionHealthBadgeWarn":"predictionHealthBadgeOk":"predictionHealthBadgeIdle";return(0,n.jsxs)("div",{className:"predictionsWrap",children:[(0,n.jsxs)("div",{className:"dashboardHeader",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{style:{margin:0},children:"Ai Predictions"}),(0,n.jsx)("div",{style:{fontSize:13,color:"var(--muted)"},children:"Select a prediction and prefill the Manual Trading Desk ticket."})]}),(0,n.jsxs)("div",{className:"predictionsHeaderActions",children:[(0,n.jsx)(t(),{href:"/dashboard",className:"btn",children:"Dashboard"}),(0,n.jsx)(t(),{href:"/trade",className:"btn",children:"Manual Trading"})]})]}),(0,n.jsxs)("section",{className:"card predictionsSection",children:[(0,n.jsx)("div",{className:"predictionCreateTitle",children:"Create Prediction"}),(0,n.jsxs)("div",{className:"predictionCreateGrid",children:[(0,n.jsxs)("label",{className:"predictionCreateField",children:[(0,n.jsx)("div",{className:"predictionCreateLabel",children:"Exchange account"}),(0,n.jsx)("div",{className:"predictionCreateHint",children:"Welcher Account sp\xe4ter beim Trading-Prefill genutzt wird."}),(0,n.jsx)("select",{className:"input",value:eT,onChange:e=>eA(e.target.value),disabled:0===eI.length,children:0===eI.length?(0,n.jsx)("option",{value:"",children:"No account available"}):eI.map(e=>(0,n.jsxs)("option",{value:e.id,children:[e.exchange.toUpperCase()," - ",e.label]},e.id))})]}),(0,n.jsxs)("label",{className:"predictionCreateField",children:[(0,n.jsx)("div",{className:"predictionCreateLabel",children:"Pair"}),(0,n.jsx)("div",{className:"predictionCreateHint",children:"Handelspaar f\xfcr die Vorhersage (aus Exchange-Symbolen)."}),(0,n.jsx)("select",{className:"input",value:e$,onChange:e=>eJ(e.target.value),disabled:eL||0===eM.length,children:eL?(0,n.jsx)("option",{value:"",children:"Loading pairs..."}):0===eM.length?(0,n.jsx)("option",{value:"",children:"No pair available"}):eM.map(e=>(0,n.jsxs)("option",{value:e.symbol,children:[e.symbol," ",e.tradable?"":"(restricted)"]},e.symbol))})]}),(0,n.jsxs)("label",{className:"predictionCreateField",children:[(0,n.jsx)("div",{className:"predictionCreateLabel",children:"Market type"}),(0,n.jsx)("div",{className:"predictionCreateHint",children:"Spot oder Perpetual f\xfcr die Interpretation."}),(0,n.jsxs)("select",{className:"input",value:eK,onChange:e=>eQ(e.target.value),children:[(0,n.jsx)("option",{value:"perp",children:"perp"}),(0,n.jsx)("option",{value:"spot",children:"spot"})]})]}),(0,n.jsxs)("label",{className:"predictionCreateField",children:[(0,n.jsx)("div",{className:"predictionCreateLabel",children:"Timeframe"}),(0,n.jsx)("div",{className:"predictionCreateHint",children:"Zeithorizont der Prognose."}),(0,n.jsx)("select",{className:"input",value:eZ,onChange:e=>e0(e.target.value),children:g.map(e=>(0,n.jsx)("option",{value:e,children:e},e))})]}),(0,n.jsxs)("label",{className:"predictionCreateField",children:[(0,n.jsx)("div",{className:"predictionCreateLabel",children:"Direction preference"}),(0,n.jsx)("div",{className:"predictionCreateHint",children:"Optional: long only, short only oder egal."}),(0,n.jsxs)("select",{className:"input",value:e1,onChange:e=>e4(e.target.value),children:[(0,n.jsx)("option",{value:"either",children:"either (egal)"}),(0,n.jsx)("option",{value:"long",children:"long preferred"}),(0,n.jsx)("option",{value:"short",children:"short preferred"})]})]}),(0,n.jsxs)("label",{className:"predictionCreateField",children:[(0,n.jsx)("div",{className:"predictionCreateLabel",children:"Signal mode"}),(0,n.jsx)("div",{className:"predictionCreateHint",children:"Bestimmt, ob nur lokal, nur AI oder beide Signale berechnet werden."}),(0,n.jsxs)("select",{className:"input",value:e2,onChange:e=>e6(e.target.value),children:[(0,n.jsx)("option",{value:"local_only",children:"Eigene Berechnung (Local only)"}),(0,n.jsx)("option",{value:"ai_only",children:"Nur AI"}),(0,n.jsx)("option",{value:"both",children:"Beides (Local + AI)"})]})]}),(0,n.jsxs)("label",{className:"predictionCreateField",children:[(0,n.jsx)("div",{className:"predictionCreateLabel",children:"Confidence target (%)"}),(0,n.jsx)("div",{className:"predictionCreateHint",children:"Mindest-Confidence f\xfcr ein klares Long/Short Signal."}),(0,n.jsx)("input",{className:"input",type:"number",step:"1",min:"0",max:"100",value:e8,onChange:e=>e5(e.target.value),placeholder:"60"})]}),(0,n.jsxs)("label",{className:"predictionCreateField",children:[(0,n.jsx)("div",{className:"predictionCreateLabel",children:"Leverage (futures)"}),(0,n.jsx)("div",{className:"predictionCreateHint",children:"Wird als Futures-Hinweis im Ticket \xfcbernommen."}),(0,n.jsx)("input",{className:"input",type:"number",step:"1",min:"1",max:"125",value:e3,onChange:e=>e9(e.target.value),placeholder:"10",disabled:"perp"!==eK})]}),(0,n.jsxs)("label",{className:"predictionCreateField",style:{justifyContent:"flex-end"},children:[(0,n.jsx)("div",{className:"predictionCreateLabel",children:"Auto schedule"}),(0,n.jsx)("div",{className:"predictionCreateHint",children:"Erstellt automatisch neue Predictions im gew\xe4hlten Timeframe."}),(0,n.jsx)("div",{className:"card",style:{margin:0},children:(0,n.jsxs)("label",{className:"predictionAutoToggle",children:[(0,n.jsx)("input",{type:"checkbox",checked:e7,onChange:e=>ie(e.target.checked)}),(0,n.jsx)("span",{style:{fontSize:13},children:e7?"Enabled":"Disabled"})]})})]})]}),eE?(0,n.jsxs)("div",{style:{marginTop:8,fontSize:12,color:"#f59e0b"},children:["Pairs konnten nicht geladen werden: ",eE]}):null,(0,n.jsx)("div",{style:{marginTop:10},children:(0,n.jsx)("button",{className:"btn btnPrimary",type:"button",disabled:K,onClick:()=>void iM(),children:K?"Creating...":"Create Prediction"})})]}),(0,n.jsxs)("section",{className:"card predictionsSection",children:[(0,n.jsxs)("div",{className:"predictionsQualityGrid",children:[(0,n.jsxs)("div",{className:"card",style:{margin:0,padding:10},children:[(0,n.jsx)("div",{style:{color:"var(--muted)",fontSize:12},children:"Evaluated Signals"}),(0,n.jsx)("div",{style:{fontSize:20,fontWeight:800},children:null!=(z=null==ed?void 0:ed.sampleSize)?z:0})]}),(0,n.jsxs)("div",{className:"card",style:{margin:0,padding:10},children:[(0,n.jsx)("div",{style:{color:"var(--muted)",fontSize:12},children:"TP Win Rate"}),(0,n.jsx)("div",{style:{fontSize:20,fontWeight:800},children:(null==ed?void 0:ed.winRatePct)!==null&&(null==ed?void 0:ed.winRatePct)!==void 0?"".concat(ed.winRatePct.toFixed(2),"%"):"-"})]}),(0,n.jsxs)("div",{className:"card",style:{margin:0,padding:10},children:[(0,n.jsx)("div",{style:{color:"var(--muted)",fontSize:12},children:"Avg Outcome PnL"}),(0,n.jsx)("div",{style:{fontSize:20,fontWeight:800},children:(null==ed?void 0:ed.avgOutcomePnlPct)!==null&&(null==ed?void 0:ed.avgOutcomePnlPct)!==void 0?"".concat(ed.avgOutcomePnlPct.toFixed(2),"%"):"-"})]}),(0,n.jsxs)("div",{className:"card",style:{margin:0,padding:10},children:[(0,n.jsx)("div",{style:{color:"var(--muted)",fontSize:12},children:"TP / SL / Expired"}),(0,n.jsxs)("div",{style:{fontSize:16,fontWeight:700},children:[null!=(B=null==ed?void 0:ed.tp)?B:0," / ",null!=(U=null==ed?void 0:ed.sl)?U:0," / ",null!=(H=null==ed?void 0:ed.expired)?H:0]})]}),(0,n.jsxs)("div",{className:"card",style:{margin:0,padding:10},children:[(0,n.jsx)("div",{style:{color:"var(--muted)",fontSize:12},children:"Directional Hit Rate"}),(0,n.jsx)("div",{style:{fontSize:20,fontWeight:800},children:(null==er?void 0:er.hitRate)!==null&&(null==er?void 0:er.hitRate)!==void 0?"".concat(er.hitRate.toFixed(2),"%"):"-"}),(0,n.jsxs)("div",{style:{color:"var(--muted)",fontSize:11},children:["Evaluated: ",null!=(V=null==er?void 0:er.evaluatedCount)?V:0]})]}),(0,n.jsxs)("div",{className:"card",style:{margin:0,padding:10},children:[(0,n.jsx)("div",{style:{color:"var(--muted)",fontSize:12},children:"MAE (Move %)"}),(0,n.jsx)("div",{style:{fontSize:20,fontWeight:800},children:(null==er?void 0:er.mae)!==null&&(null==er?void 0:er.mae)!==void 0?er.mae.toFixed(4):"-"})]}),(0,n.jsxs)("div",{className:"card",style:{margin:0,padding:10},children:[(0,n.jsx)("div",{style:{color:"var(--muted)",fontSize:12},children:"MSE"}),(0,n.jsx)("div",{style:{fontSize:20,fontWeight:800},children:(null==er?void 0:er.mse)!==null&&(null==er?void 0:er.mse)!==void 0?er.mse.toFixed(4):"-"})]}),(0,n.jsxs)("div",{className:"card",style:{margin:0,padding:10},children:[(0,n.jsx)("div",{style:{color:"var(--muted)",fontSize:12},children:"24h Hit Rate Local / AI"}),(0,n.jsx)("div",{style:{fontSize:18,fontWeight:800},children:(null==ed||null==(e=ed.comparison24h)?void 0:e.localHitRatePct)!==null&&(null==ed||null==(i=ed.comparison24h)?void 0:i.localHitRatePct)!==void 0&&(null==ed||null==(a=ed.comparison24h)?void 0:a.aiHitRatePct)!==null&&(null==ed||null==(l=ed.comparison24h)?void 0:l.aiHitRatePct)!==void 0?"".concat(ed.comparison24h.localHitRatePct.toFixed(2),"% / ").concat(ed.comparison24h.aiHitRatePct.toFixed(2),"%"):"-"}),(0,n.jsxs)("div",{style:{color:"var(--muted)",fontSize:11},children:["Δ AI-Local: ",(null==ed||null==(c=ed.comparison24h)?void 0:c.deltaAiVsLocalPct)!==null&&(null==ed||null==(u=ed.comparison24h)?void 0:u.deltaAiVsLocalPct)!==void 0?"".concat(ed.comparison24h.deltaAiVsLocalPct>=0?"+":"").concat(ed.comparison24h.deltaAiVsLocalPct.toFixed(2)," pp"):"n/a"," \xb7 N=",null!=(W=null==ed||null==(p=ed.comparison24h)?void 0:p.sampleSize)?W:0]})]}),(0,n.jsxs)("div",{className:"card predictionActivityCard",style:{margin:0,padding:10},children:[(0,n.jsxs)("div",{className:"predictionActivityHeader",children:[(0,n.jsx)("div",{style:{color:"var(--muted)",fontSize:12},children:"AI Refresh"}),(0,n.jsx)("span",{className:"badge ".concat(iY),children:eh?"loading":iO})]}),(0,n.jsxs)("div",{className:"predictionActivityLine",children:[(0,n.jsx)("span",{children:"Last calc"}),(0,n.jsx)("strong",{title:iV?new Date(iV).toLocaleString():"n/a",children:eh?"...":v(iV,ii)})]}),(0,n.jsxs)("div",{className:"predictionActivityLine",children:[(0,n.jsx)("span",{children:"Last cycle"}),(0,n.jsx)("strong",{title:(null==eu?void 0:eu.scheduler.lastCycleFinishedAt)?new Date(eu.scheduler.lastCycleFinishedAt).toLocaleString():"n/a",children:eh?"...":v(null!=(O=null==eu?void 0:eu.scheduler.lastCycleFinishedAt)?O:null,ii)})]}),(0,n.jsxs)("div",{className:"predictionActivityLine",children:[(0,n.jsx)("span",{children:"Reason"}),(0,n.jsx)("strong",{title:null!=(Y=iB.rawReason)?Y:"n/a",children:eh?"...":iB.shortReason})]}),iW?(0,n.jsxs)("div",{className:"predictionActivityWarning",children:["No fresh signal calculation in ",Math.ceil(iH/6e4),"m."]}):null]})]}),(0,n.jsxs)("div",{className:"predictionCalibrationWrap",children:[(0,n.jsxs)("div",{className:"predictionCalibrationHeader",children:[(0,n.jsx)("strong",{children:"Confidence Calibration (10 bins)"}),(0,n.jsx)("span",{style:{color:"var(--muted)",fontSize:12},children:"predicted confidence vs. empirical accuracy"})]}),er&&0!==er.calibrationBins.filter(e=>e.n>0).length?(0,n.jsx)("div",{className:"predictionCalibrationTableWrap",children:(0,n.jsxs)("table",{className:"predictionCalibrationTable",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Bin"}),(0,n.jsx)("th",{children:"Avg conf"}),(0,n.jsx)("th",{children:"Accuracy"}),(0,n.jsx)("th",{children:"N"})]})}),(0,n.jsx)("tbody",{children:er.calibrationBins.filter(e=>e.n>0).map(e=>(0,n.jsxs)("tr",{children:[(0,n.jsxs)("td",{children:[e.binFrom.toFixed(0),"-",e.binTo.toFixed(0),"%"]}),(0,n.jsx)("td",{children:null!==e.avgConf?"".concat(e.avgConf.toFixed(2),"%"):"-"}),(0,n.jsx)("td",{children:null!==e.accuracy?"".concat(e.accuracy.toFixed(2),"%"):"-"}),(0,n.jsx)("td",{children:e.n})]},"".concat(e.binFrom,"-").concat(e.binTo)))})]})}):(0,n.jsx)("div",{className:"predictionCalibrationEmpty",children:"No evaluated bins yet."})]})]}),(0,n.jsxs)("section",{className:"card predictionsSection",children:[(0,n.jsxs)("div",{className:"predictionsRunningHeader",children:[(0,n.jsxs)("div",{style:{fontWeight:700},children:["Running Auto Predictions (",iI.length,"/",ev.length,")"]}),(0,n.jsxs)("div",{className:"predictionsRunningActions",children:[(0,n.jsxs)("select",{className:"input",value:ey,onChange:e=>eN(e.target.value),style:{minWidth:150},children:[(0,n.jsx)("option",{value:"all",children:"Status: all"}),(0,n.jsx)("option",{value:"running",children:"Status: running"}),(0,n.jsx)("option",{value:"paused",children:"Status: paused"})]}),(0,n.jsx)("button",{className:"btn",type:"button",onClick:()=>{Promise.all([iN(),iC()])},disabled:eg,children:eg?"Refreshing...":"Refresh"})]})]}),eg?(0,n.jsx)("div",{style:{color:"var(--muted)"},children:"Loading running schedules…"}):0===ev.length?(0,n.jsxs)("div",{style:{color:"var(--muted)"},children:["No running auto-predictions. Enable ",(0,n.jsx)("code",{children:"Auto schedule"})," when creating a prediction."]}):0===iI.length?(0,n.jsx)("div",{style:{color:"var(--muted)"},children:"No entries for selected status filter."}):(0,n.jsx)("div",{style:{overflowX:"auto"},children:(0,n.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{style:{textAlign:"left",color:"var(--muted)"},children:[(0,n.jsx)("th",{style:{padding:"8px 6px"},children:"Pair"}),(0,n.jsx)("th",{style:{padding:"8px 6px"},children:"TF"}),(0,n.jsx)("th",{style:{padding:"8px 6px"},children:"Market"}),(0,n.jsx)("th",{style:{padding:"8px 6px"},children:"Account"}),(0,n.jsx)("th",{style:{padding:"8px 6px"},children:"Prefs"}),(0,n.jsx)("th",{style:{padding:"8px 6px"},children:"Status"}),(0,n.jsx)("th",{style:{padding:"8px 6px"},children:"Next run"}),(0,n.jsx)("th",{style:{padding:"8px 6px"},children:"Actions"})]})}),(0,n.jsx)("tbody",{children:iI.map(e=>(0,n.jsxs)("tr",{style:{borderTop:"1px solid rgba(255,255,255,.06)"},children:[(0,n.jsx)("td",{style:{padding:"8px 6px",fontWeight:700},children:e.symbol}),(0,n.jsx)("td",{style:{padding:"8px 6px"},children:e.timeframe}),(0,n.jsx)("td",{style:{padding:"8px 6px"},children:e.marketType}),(0,n.jsxs)("td",{style:{padding:"8px 6px"},children:[e.exchange.toUpperCase()," - ",e.label]}),(0,n.jsxs)("td",{style:{padding:"8px 6px"},children:["Dir: ",e.directionPreference,", conf: ",e.confidenceTargetPct,"%","perp"===e.marketType&&e.leverage?", lev: ".concat(e.leverage,"x"):"",", mode: ".concat(R(e.signalMode))]}),(0,n.jsx)("td",{style:{padding:"8px 6px"},children:e.paused?"paused":"running"}),(0,n.jsx)("td",{style:{padding:"8px 6px"},children:e.paused?"paused":e.dueInSec<=0?"due now":"in ".concat(f(1e3*e.dueInSec))}),(0,n.jsxs)("td",{style:{padding:"8px 6px",display:"flex",gap:6,flexWrap:"wrap"},children:[(0,n.jsx)("button",{className:"btn",type:"button",disabled:ej===e.id,onClick:()=>void iF(e),children:e.paused?"Resume":"Pause prediction"}),(0,n.jsx)("button",{className:"btn",type:"button",disabled:ej===e.id,onClick:()=>void iL(e.id),children:"Delete"})]})]},e.id))})]})}),(0,n.jsxs)("div",{className:"predictionsCleanupRow",children:[(0,n.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,n.jsx)("span",{style:{color:"var(--muted)",fontSize:12},children:"Older than (days)"}),(0,n.jsx)("input",{className:"input",type:"number",min:"1",max:"3650",step:"1",value:e_,onChange:e=>eS(e.target.value),style:{width:120}})]}),(0,n.jsx)("button",{className:"btn",type:"button",disabled:eC,onClick:()=>void iD(),children:eC?"Clearing...":"Clear old predictions"}),(0,n.jsx)("span",{style:{color:"var(--muted)",fontSize:12},children:"Deletes historical rows but keeps active schedule templates."})]})]}),Z?(0,n.jsxs)("div",{className:"card",style:{padding:12,borderColor:"#ef4444",marginBottom:12},children:[(0,n.jsx)("strong",{children:"Load error:"})," ",Z]}):null,ei?(0,n.jsxs)("div",{className:"card",style:{padding:12,borderColor:"#ef4444",marginBottom:12},children:[(0,n.jsx)("strong",{children:"Action failed:"})," ",ei]}):null,ic?(0,n.jsxs)("div",{className:"card",style:{padding:12,borderColor:"#ef4444",marginBottom:12},children:[(0,n.jsx)("strong",{children:"Detail load failed:"})," ",ic]}):null,et?(0,n.jsxs)("div",{className:"card",style:{padding:12,borderColor:"#f59e0b",marginBottom:12},children:[(0,n.jsx)("strong",{children:"Notice:"})," ",et]}):null,(0,n.jsx)("section",{className:"card predictionsSection",children:(0,n.jsxs)("div",{className:"predictionsFiltersGrid",children:[(0,n.jsx)("input",{className:"input",placeholder:"Filter symbol...",value:eB,onChange:e=>eU(e.target.value)}),(0,n.jsxs)("select",{className:"input",value:eH,onChange:e=>eV(e.target.value),children:[(0,n.jsx)("option",{value:"all",children:"All signals"}),(0,n.jsx)("option",{value:"up",children:"up"}),(0,n.jsx)("option",{value:"down",children:"down"}),(0,n.jsx)("option",{value:"neutral",children:"neutral"})]}),(0,n.jsxs)("select",{className:"input",value:eW,onChange:e=>eO(e.target.value),children:[(0,n.jsx)("option",{value:"all",children:"All TF"}),g.map(e=>(0,n.jsx)("option",{value:e,children:e},e))]}),(0,n.jsxs)("select",{className:"input",value:eY,onChange:e=>eG(e.target.value),children:[(0,n.jsx)("option",{value:"local",children:"Signal Source: Local"}),(0,n.jsx)("option",{value:"ai",children:"Signal Source: AI (fallback local)"})]}),(0,n.jsxs)("select",{className:"input",value:eq,onChange:e=>eX(e.target.value),children:[(0,n.jsx)("option",{value:"newest",children:"Sort: Newest"}),(0,n.jsx)("option",{value:"confidence",children:"Sort: Confidence"}),(0,n.jsx)("option",{value:"move",children:"Sort: Move size"})]}),(0,n.jsx)("button",{className:"btn",type:"button",onClick:()=>{Promise.all([iy(),i_(),iS(),iC()])},disabled:$,children:$?"Refreshing...":"Refresh"}),(0,n.jsx)("button",{className:"btn",type:"button",onClick:()=>void iE(),disabled:eP||0===ik.length,title:0===ik.length?"No rows match current filters":"Delete currently listed rows",children:eP?"Deleting...":"Clear listed (".concat(ik.length,")")})]})}),$?(0,n.jsx)("div",{className:"card",style:{padding:14},children:"Loading predictions…"}):0===ik.length?(0,n.jsxs)("div",{className:"card",style:{padding:14},children:[(0,n.jsx)("div",{style:{fontWeight:700,marginBottom:8},children:"No predictions found"}),(0,n.jsx)("div",{style:{color:"var(--muted)"},children:"Adjust filters or create a new prediction above."})]}):(0,n.jsxs)("section",{className:"card",style:{padding:12},children:[(0,n.jsx)("div",{className:"predictionsDesktopTableWrap",style:{overflowX:"auto"},children:(0,n.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{style:{textAlign:"left",color:"var(--muted)"},children:[(0,n.jsx)("th",{style:{padding:"8px 6px"},children:"Symbol"}),(0,n.jsx)("th",{style:{padding:"8px 6px"},children:"Market"}),(0,n.jsx)("th",{style:{padding:"8px 6px"},children:"TF"}),(0,n.jsx)("th",{style:{padding:"8px 6px"},children:"Signal"}),(0,n.jsx)("th",{style:{padding:"8px 6px"},children:"Confidence"}),(0,n.jsx)("th",{style:{padding:"8px 6px"},children:"Move"}),(0,n.jsx)("th",{style:{padding:"8px 6px"},children:"Auto"}),(0,n.jsx)("th",{style:{padding:"8px 6px"},children:"Outcome"}),(0,n.jsx)("th",{style:{padding:"8px 6px"},children:"Outcome PnL"}),(0,n.jsx)("th",{style:{padding:"8px 6px"},children:"Tags / Explanation"}),(0,n.jsx)("th",{style:{padding:"8px 6px"},children:"Last Updated"}),(0,n.jsx)("th",{style:{padding:"8px 6px"},children:"Change"}),(0,n.jsx)("th",{style:{padding:"8px 6px"},children:"Created"}),(0,n.jsx)("th",{style:{padding:"8px 6px"},children:"Action"})]})}),(0,n.jsx)("tbody",{children:ik.map(e=>{var i,a,l,t,s,o;let r=P(e,eY),c=k(e,eY),u=I(e,eY),p=null!=(l=null==(i=e.localPrediction)?void 0:i.signal)?l:e.signal,h=!!e.aiPrediction,g=h&&e.aiPrediction.signal!==p,f=N(c),b="number"==typeof e.confidenceTargetPct&&Number.isFinite(e.confidenceTargetPct)?Math.max(0,Math.min(100,e.confidenceTargetPct)):0,C=f<b,w=il===e.id,T=io===e.id,A=null!=(t=e.lastUpdatedAt)?t:e.tsCreated,L=m(null!=(s=e.lastChangeReason)?s:null),D=F({parsedReason:L,autoEnabled:!!e.autoScheduleEnabled}),E=!!L.signalFlip&&x(A,ii,9e5),z="triggered"===L.kind?"predictionReasonBadgeTrigger":"scheduled"===L.kind?"predictionReasonBadgeScheduled":"manual"===L.kind?"predictionReasonBadgeManual":"predictionReasonBadgeUnknown";return(0,n.jsxs)(d.Fragment,{children:[(0,n.jsxs)("tr",{className:E?"predictionRowFlipRecent":void 0,style:{borderTop:"1px solid rgba(255,255,255,.06)"},children:[(0,n.jsx)("td",{style:{padding:"8px 6px",fontWeight:700},children:e.symbol}),(0,n.jsx)("td",{style:{padding:"8px 6px"},children:e.marketType}),(0,n.jsx)("td",{style:{padding:"8px 6px"},children:e.timeframe}),(0,n.jsxs)("td",{style:{padding:"8px 6px"},children:[(0,n.jsx)("span",{className:"badge",style:_(r),children:r}),h?(0,n.jsxs)("div",{style:{color:"var(--muted)",fontSize:11,marginTop:4},children:["local ",p," / ai ",null==(a=e.aiPrediction)?void 0:a.signal]}):null,"ai"!==eY||h?null:(0,n.jsx)("div",{style:{color:"var(--muted)",fontSize:11,marginTop:4},children:"ai n/a, using local"}),g?(0,n.jsx)("div",{style:{color:"#f59e0b",fontSize:11,marginTop:4},children:"disagreement"}):null,(0,n.jsxs)("div",{style:{color:"var(--muted)",fontSize:11,marginTop:4},children:["mode ",R(e.signalMode)]})]}),(0,n.jsx)("td",{style:{padding:"8px 6px"},children:y(c)}),(0,n.jsxs)("td",{style:{padding:"8px 6px"},children:[u.toFixed(2),"%"]}),(0,n.jsxs)("td",{style:{padding:"8px 6px"},children:[(0,n.jsx)("div",{children:e.autoScheduleEnabled?"enabled":"off"}),(0,n.jsxs)("div",{style:{color:"var(--muted)",fontSize:12},children:["Next: ",j(e,ii)]})]}),(0,n.jsx)("td",{style:{padding:"8px 6px"},children:S(e.outcomeStatus,e.outcomeResult)}),(0,n.jsx)("td",{style:{padding:"8px 6px"},children:null!==e.outcomePnlPct&&void 0!==e.outcomePnlPct?"".concat(e.outcomePnlPct.toFixed(2),"%"):"-"}),(0,n.jsxs)("td",{style:{padding:"8px 6px",maxWidth:360},children:[(0,n.jsx)("div",{style:{display:"flex",gap:4,flexWrap:"wrap",marginBottom:4},children:e.tags.slice(0,4).map(i=>(0,n.jsx)("span",{className:"badge",children:i},"".concat(e.id,"_").concat(i)))}),(0,n.jsx)("div",{style:{color:"var(--muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.explanation||"-"})]}),(0,n.jsx)("td",{style:{padding:"8px 6px"},children:(0,n.jsx)("div",{className:"predictionUpdateCell",children:(0,n.jsx)("span",{className:"predictionUpdateMeta ".concat(x(A,ii,12e4)?"predictionUpdateMetaFresh":""),title:A?new Date(A).toLocaleString():"n/a",children:v(A,ii)})})}),(0,n.jsx)("td",{style:{padding:"8px 6px",maxWidth:200},children:(0,n.jsxs)("div",{className:"predictionChangeCell",children:[(0,n.jsxs)("div",{className:"predictionChangeBadges",children:[(0,n.jsx)("span",{className:"badge ".concat(z),children:D.label}),L.signalFlip?(0,n.jsxs)("span",{className:"badge predictionFlipBadge",children:["FLIP ",M(L.signalFlip)]}):null]}),(0,n.jsx)("div",{className:"predictionChangeText",title:null!=(o=D.rawReason)?o:"n/a",children:D.shortReason})]})}),(0,n.jsx)("td",{style:{padding:"8px 6px"},children:new Date(e.tsCreated).toLocaleString()}),(0,n.jsx)("td",{style:{padding:"8px 6px"},children:(0,n.jsxs)("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:["neutral"===r?(0,n.jsx)("span",{style:{color:"var(--muted)",fontSize:12},children:"No trade setup"}):C?(0,n.jsxs)("span",{style:{color:"var(--muted)",fontSize:12},children:["Below confidence target (",b.toFixed(0),"%)"]}):(0,n.jsx)("button",{className:"btn btnPrimary",onClick:()=>void iR(e.id),disabled:en===e.id||!e.accountId,title:e.accountId?"Prefill trade ticket":"Create an exchange account first",children:en===e.id?"Sending...":"Send to Trading Desk"}),(0,n.jsx)("button",{className:"btn",type:"button",onClick:()=>void iT(e.id),disabled:T&&!w,children:w?"Hide details":"Details"})]})})]}),w?(0,n.jsx)("tr",{style:{borderTop:"1px dashed rgba(255,255,255,.08)"},children:(0,n.jsx)("td",{colSpan:14,style:{padding:"10px 6px"},children:iz(e)})}):null]},e.id)})})]})}),(0,n.jsx)("div",{className:"predictionsMobileList",children:ik.map(e=>{var i,a,l;let t=P(e,eY),s=k(e,eY),d=I(e,eY),o=N(s),r="number"==typeof e.confidenceTargetPct&&Number.isFinite(e.confidenceTargetPct)?Math.max(0,Math.min(100,e.confidenceTargetPct)):0,c=o<r,u=il===e.id,p=io===e.id,h=null!=(i=e.lastUpdatedAt)?i:e.tsCreated,x=m(null!=(a=e.lastChangeReason)?a:null),g=F({parsedReason:x,autoEnabled:!!e.autoScheduleEnabled}),f="triggered"===x.kind?"predictionReasonBadgeTrigger":"scheduled"===x.kind?"predictionReasonBadgeScheduled":"manual"===x.kind?"predictionReasonBadgeManual":"predictionReasonBadgeUnknown";return(0,n.jsxs)("div",{className:"card predictionRowCard",children:[(0,n.jsxs)("div",{className:"predictionRowCardHeader",children:[(0,n.jsx)("div",{className:"predictionRowCardSymbol",children:e.symbol}),(0,n.jsx)("span",{className:"badge",style:_(t),children:t})]}),(0,n.jsxs)("div",{className:"predictionRowCardMeta",children:[(0,n.jsx)("span",{children:e.marketType}),(0,n.jsx)("span",{children:e.timeframe}),(0,n.jsx)("span",{children:R(e.signalMode)}),(0,n.jsx)("span",{children:new Date(e.tsCreated).toLocaleString()}),(0,n.jsxs)("span",{title:h?new Date(h).toLocaleString():"n/a",children:["Updated ",v(h,ii)]})]}),(0,n.jsxs)("div",{className:"predictionRowCardStats",children:[(0,n.jsxs)("div",{className:"predictionRowCardStat",children:[(0,n.jsx)("div",{className:"predictionRowCardStatLabel",children:"Confidence"}),(0,n.jsx)("div",{className:"predictionRowCardStatValue",children:y(s)})]}),(0,n.jsxs)("div",{className:"predictionRowCardStat",children:[(0,n.jsx)("div",{className:"predictionRowCardStatLabel",children:"Move"}),(0,n.jsxs)("div",{className:"predictionRowCardStatValue",children:[d.toFixed(2),"%"]})]}),(0,n.jsxs)("div",{className:"predictionRowCardStat",children:[(0,n.jsx)("div",{className:"predictionRowCardStatLabel",children:"Outcome"}),(0,n.jsx)("div",{className:"predictionRowCardStatValue",children:S(e.outcomeStatus,e.outcomeResult)})]}),(0,n.jsxs)("div",{className:"predictionRowCardStat",children:[(0,n.jsx)("div",{className:"predictionRowCardStatLabel",children:"Outcome PnL"}),(0,n.jsx)("div",{className:"predictionRowCardStatValue",children:null!==e.outcomePnlPct&&void 0!==e.outcomePnlPct?"".concat(e.outcomePnlPct.toFixed(2),"%"):"-"})]})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:4,flexWrap:"wrap",marginBottom:6},children:[(0,n.jsx)("span",{className:"badge ".concat(f),children:g.label}),x.signalFlip?(0,n.jsxs)("span",{className:"badge predictionFlipBadge",children:["FLIP ",M(x.signalFlip)]}):null,e.tags.slice(0,4).map(i=>(0,n.jsx)("span",{className:"badge",children:i},"".concat(e.id,"_m_").concat(i)))]}),(0,n.jsx)("div",{className:"predictionRowCardText",title:null!=(l=g.rawReason)?l:"n/a",children:g.shortReason}),(0,n.jsx)("div",{className:"predictionRowCardText",children:e.explanation||"-"}),(0,n.jsxs)("div",{className:"predictionRowCardAuto",children:[(0,n.jsx)("span",{children:e.autoScheduleEnabled?"Auto: enabled":"Auto: off"}),(0,n.jsxs)("span",{children:["Next: ",j(e,ii)]})]}),(0,n.jsxs)("div",{className:"predictionRowCardActions",children:["neutral"===t?(0,n.jsx)("span",{style:{color:"var(--muted)",fontSize:12},children:"No trade setup"}):c?(0,n.jsxs)("span",{style:{color:"var(--muted)",fontSize:12},children:["Below confidence target (",r.toFixed(0),"%)"]}):(0,n.jsx)("button",{className:"btn btnPrimary",onClick:()=>void iR(e.id),disabled:en===e.id||!e.accountId,title:e.accountId?"Prefill trade ticket":"Create an exchange account first",children:en===e.id?"Sending...":"Send to Trading Desk"}),(0,n.jsx)("button",{className:"btn",type:"button",onClick:()=>void iT(e.id),disabled:p&&!u,children:u?"Hide details":"Details"})]}),u?(0,n.jsx)("div",{className:"predictionRowCardDetail",children:iz(e)}):null]},"".concat(e.id,"_mobile"))})})]})]})}}},e=>{e.O(0,[664,768,587,18,358],()=>e(e.s=7199)),_N_E=e.O()}]);