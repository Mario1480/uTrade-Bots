(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[547],{945:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>o});var s=t(4568),a=t(9664),l=t.n(a),i=t(7620),c=t(2883);function r(e){return e instanceof c.hD?"".concat(e.message," (HTTP ").concat(e.status,")"):e&&"object"==typeof e&&"message"in e?String(e.message):String(e)}function o(){let[e,n]=(0,i.useState)(!0),[t,a]=(0,i.useState)(!1),[o,u]=(0,i.useState)(null),[d,h]=(0,i.useState)(null),[m,f]=(0,i.useState)([]);async function g(){n(!0),u(null);try{var e;let n=await (0,c.Vg)("/auth/me");if(!(null==n?void 0:n.isSuperadmin)){a(!1),u("Superadmin access required.");return}a(!0);let t=await (0,c.Vg)("/admin/settings/exchanges");f(null!=(e=t.options)?e:[])}catch(e){u(r(e))}finally{n(!1)}}async function p(){u(null),h(null);try{var e;let n=m.filter(e=>e.enabled).map(e=>e.value),t=await (0,c.mu)("/admin/settings/exchanges",{allowed:n});f(null!=(e=t.options)?e:[]),h("Exchange offer updated.")}catch(e){u(r(e))}}return(0,i.useEffect)(()=>{g()},[]),(0,s.jsxs)("div",{className:"settingsWrap",children:[(0,s.jsxs)("div",{style:{marginBottom:10,display:"flex",gap:8,flexWrap:"wrap"},children:[(0,s.jsx)(l(),{href:"/admin",className:"btn",children:"← Back to admin"}),(0,s.jsx)(l(),{href:"/settings",className:"btn",children:"← Back to settings"})]}),(0,s.jsx)("h2",{style:{marginTop:0},children:"Admin \xb7 Offered Exchanges"}),e?(0,s.jsx)("div",{children:"Loading..."}):null,o?(0,s.jsx)("div",{className:"card settingsSection",style:{borderColor:"#ef4444",marginBottom:12},children:o}):null,d?(0,s.jsx)("div",{className:"card settingsSection",style:{borderColor:"#22c55e",marginBottom:12},children:d}):null,t?(0,s.jsxs)("section",{className:"card settingsSection",children:[(0,s.jsx)("div",{className:"settingsSectionHeader",children:(0,s.jsx)("h3",{style:{margin:0},children:"Exchange Availability"})}),(0,s.jsx)("div",{style:{fontSize:12,color:"var(--muted)",marginBottom:10},children:"Enabled exchanges are offered to users in exchange account setup."}),(0,s.jsx)("div",{style:{display:"grid",gap:6},children:m.map((e,n)=>(0,s.jsxs)("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,s.jsx)("input",{type:"checkbox",checked:e.enabled,onChange:e=>f(t=>t.map((t,s)=>s===n?{...t,enabled:e.target.checked}:t))}),(0,s.jsx)("span",{children:e.label})]},e.value))}),(0,s.jsx)("div",{style:{marginTop:10},children:(0,s.jsx)("button",{className:"btn btnPrimary",onClick:()=>void p(),children:"Save exchanges"})})]}):null]})}},2877:(e,n,t)=>{Promise.resolve().then(t.bind(t,945))},2883:(e,n,t)=>{"use strict";t.d(n,{$P:()=>h,Al:()=>f,GC:()=>g,Vg:()=>d,hD:()=>o,mu:()=>m});var s,a,l,i,c=t(7011);null!=(null!=(s=c.env.API_URL)?s:c.env.API_BASE_URL)||c.env.NEXT_PUBLIC_API_URL;let r=null!=(i=null!=(l=null!=(a=c.env.NEXT_PUBLIC_API_URL)?a:c.env.API_URL)?l:c.env.API_BASE_URL)?i:"http://localhost:4000";class o extends Error{constructor(e,n,t){super(e),this.status=n,this.payload=t}}async function u(e,n,t){let s={"Content-Type":"application/json"};if(!["GET","HEAD","OPTIONS"].includes(e)){let e=function(e){if("undefined"==typeof document)return null;let n=document.cookie.match(new RegExp("(^|; )".concat(e,"=([^;]*)")));return n?decodeURIComponent(n[2]):null}("mm_csrf");e&&(s["x-csrf-token"]=e)}let a=await fetch("".concat(r).concat(n),{method:e,headers:s,body:t?JSON.stringify(t):void 0,credentials:"include",cache:"no-store"});if(!a.ok){let t=null;try{t=await a.json()}catch(e){}throw new o((null==t?void 0:t.error)||(null==t?void 0:t.message)||"".concat(e," ").concat(n," failed (").concat(a.status,")"),a.status,t)}return a.json()}function d(e){return u("GET",e)}function h(e,n){return u("POST",e,n)}function m(e,n){return u("PUT",e,n)}function f(e){return u("DELETE",e)}function g(e){return u("DELETE",e)}}},e=>{e.O(0,[664,587,18,358],()=>e(e.s=2877)),_N_E=e.O()}]);