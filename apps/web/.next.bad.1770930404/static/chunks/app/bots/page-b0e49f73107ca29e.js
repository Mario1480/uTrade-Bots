(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[885],{1826:(e,t,n)=>{Promise.resolve().then(n.bind(n,3971))},2883:(e,t,n)=>{"use strict";n.d(t,{$P:()=>h,Al:()=>f,GC:()=>g,Vg:()=>d,hD:()=>i,mu:()=>m});var a,s,r,c,l=n(7011);null!=(null!=(a=l.env.API_URL)?a:l.env.API_BASE_URL)||l.env.NEXT_PUBLIC_API_URL;let o=null!=(c=null!=(r=null!=(s=l.env.NEXT_PUBLIC_API_URL)?s:l.env.API_URL)?r:l.env.API_BASE_URL)?c:"http://localhost:4000";class i extends Error{constructor(e,t,n){super(e),this.status=t,this.payload=n}}async function u(e,t,n){let a={"Content-Type":"application/json"};if(!["GET","HEAD","OPTIONS"].includes(e)){let e=function(e){if("undefined"==typeof document)return null;let t=document.cookie.match(new RegExp("(^|; )".concat(e,"=([^;]*)")));return t?decodeURIComponent(t[2]):null}("mm_csrf");e&&(a["x-csrf-token"]=e)}let s=await fetch("".concat(o).concat(t),{method:e,headers:a,body:n?JSON.stringify(n):void 0,credentials:"include",cache:"no-store"});if(!s.ok){let n=null;try{n=await s.json()}catch(e){}throw new i((null==n?void 0:n.error)||(null==n?void 0:n.message)||"".concat(e," ").concat(t," failed (").concat(s.status,")"),s.status,n)}return s.json()}function d(e){return u("GET",e)}function h(e,t){return u("POST",e,t)}function m(e,t){return u("PUT",e,t)}function f(e){return u("DELETE",e)}function g(e){return u("DELETE",e)}},3971:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>u});var a=n(4568),s=n(9664),r=n.n(s),c=n(7620),l=n(7541),o=n(2883);function i(){let e=(0,l.useSearchParams)(),[t,n]=(0,c.useState)([]),[s,i]=(0,c.useState)(!0),[u,d]=(0,c.useState)(null),h=e.get("exchangeAccountId"),m=e.get("status");(0,c.useEffect)(()=>{let e=!0;async function t(){i(!0),d(null);try{let t=await (0,o.Vg)("/bots");if(!e)return;n(Array.isArray(t)?t:[])}catch(t){if(!e)return;d(t instanceof o.hD?"".concat(t.message," (HTTP ").concat(t.status,")"):t&&"object"==typeof t&&"message"in t?String(t.message):String(t))}finally{e&&i(!1)}}t();let a=setInterval(()=>{t()},6e3);return()=>{e=!1,clearInterval(a)}},[]);let f=(0,c.useMemo)(()=>t.filter(e=>(!h||e.exchangeAccountId===h)&&(!m||e.status===m)),[t,h,m]),g=(0,c.useMemo)(()=>h?" for account ".concat(h.slice(0,8),"…"):"",[h]);return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"dashboardHeader",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{style:{margin:0},children:["Bots",g]}),(0,a.jsx)("div",{style:{fontSize:13,color:"var(--muted)"},children:m?"Status filter: ".concat(m):"All bot statuses"})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[(0,a.jsx)(r(),{href:"/dashboard",className:"btn",children:"Dashboard"}),(0,a.jsx)(r(),{href:"/bots/new",className:"btn btnPrimary",children:"New Bot"})]})]}),u?(0,a.jsxs)("div",{className:"card",style:{padding:12,borderColor:"#ef4444",marginBottom:12},children:[(0,a.jsx)("strong",{children:"Load error:"})," ",u]}):null,(0,a.jsx)("div",{className:"botGrid",children:s?(0,a.jsx)("div",{className:"card",style:{padding:16},children:"Loading bots…"}):0===f.length?(0,a.jsxs)("div",{className:"card",style:{padding:16},children:[(0,a.jsx)("div",{style:{fontWeight:700,marginBottom:6},children:"No bots match this filter"}),(0,a.jsx)("div",{style:{fontSize:13,color:"var(--muted)",marginBottom:10},children:"Try another account/status filter or create a new bot."}),(0,a.jsx)(r(),{href:"/bots/new",className:"btn btnPrimary",children:"Create Bot"})]}):f.map(e=>{var t,n,s,c,l;return(0,a.jsxs)("article",{className:"card botCard",children:[(0,a.jsxs)("div",{className:"botCardHeader",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"botName",children:e.name}),(0,a.jsxs)("div",{className:"botMeta",children:[null!=(c=null==(t=e.exchangeAccount)?void 0:t.label)?c:"No Account"," \xb7 ",e.exchange," \xb7 ",e.symbol]})]}),(0,a.jsx)("span",{className:"badge ".concat("running"===e.status?"badgeOk":"error"===e.status?"badgeDanger":"badgeWarn"),children:e.status})]}),e.lastError||(null==(n=e.runtime)?void 0:n.lastError)?(0,a.jsx)("div",{style:{marginTop:10,fontSize:12,color:"#fecaca"},children:null!=(l=e.lastError)?l:null==(s=e.runtime)?void 0:s.lastError}):null,(0,a.jsxs)("div",{style:{marginTop:12,display:"flex",gap:8,flexWrap:"wrap"},children:[(0,a.jsx)(r(),{href:"/bots/".concat(e.id),className:"btn",children:"Open"}),e.exchangeAccountId?(0,a.jsx)(r(),{href:"/trade?exchangeAccountId=".concat(encodeURIComponent(e.exchangeAccountId)),className:"btn",children:"Manual Trading"}):null]})]},e.id)})})]})}function u(){return(0,a.jsx)(c.Suspense,{fallback:(0,a.jsx)("div",{children:"Loading bots page…"}),children:(0,a.jsx)(i,{})})}},7541:(e,t,n)=>{"use strict";var a=n(3041);n.o(a,"useParams")&&n.d(t,{useParams:function(){return a.useParams}}),n.o(a,"usePathname")&&n.d(t,{usePathname:function(){return a.usePathname}}),n.o(a,"useRouter")&&n.d(t,{useRouter:function(){return a.useRouter}}),n.o(a,"useSearchParams")&&n.d(t,{useSearchParams:function(){return a.useSearchParams}})}},e=>{e.O(0,[664,587,18,358],()=>e(e.s=1826)),_N_E=e.O()}]);