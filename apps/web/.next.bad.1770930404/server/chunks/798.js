"use strict";exports.id=798,exports.ids=[798],exports.modules={28298:(a,b,c)=>{c.r(b),c.d(b,{default:()=>t});var d=c(78157),e=c(94496),f=c.n(e),g=c(31768),h=c(71159),i=c(72637);c(30682),c(48046);let j={ema5:!1,ema13:!1,ema50:!0,ema200:!0,ema800:!1,emaCloud50:!1,vwapSession:!1,dailyOpen:!1},k={scalping:{label:"Scalping",toggles:{ema5:!0,ema13:!0,ema50:!1,ema200:!1,ema800:!1,emaCloud50:!1,vwapSession:!0,dailyOpen:!0}},trend:{label:"Trend",toggles:{ema5:!1,ema13:!1,ema50:!0,ema200:!0,ema800:!0,emaCloud50:!0,vwapSession:!1,dailyOpen:!0}},off:{label:"Alle aus",toggles:{ema5:!1,ema13:!1,ema50:!1,ema200:!1,ema800:!1,emaCloud50:!1,vwapSession:!1,dailyOpen:!1}},all:{label:"Alle an",toggles:{ema5:!0,ema13:!0,ema50:!0,ema200:!0,ema800:!0,emaCloud50:!0,vwapSession:!0,dailyOpen:!0}}};function l({exchangeAccountId:a,symbol:b,timeframe:c,prefill:e}){let f=(0,g.useRef)(null);(0,g.useRef)(null),(0,g.useRef)(null),(0,g.useRef)([]),(0,g.useRef)({ema5:null,ema13:null,ema50:null,ema200:null,ema800:null}),(0,g.useRef)(null),(0,g.useRef)(null),(0,g.useRef)(null),(0,g.useRef)(null),(0,g.useRef)(null);let[h,i]=(0,g.useState)("loading"),[l,m]=(0,g.useState)("Loading candles..."),[n,o]=(0,g.useState)([]),[p,q]=(0,g.useState)(null),[r,s]=(0,g.useState)(!1),[t,u]=(0,g.useState)(!1),[v,w]=(0,g.useState)(j),x=(0,g.useMemo)(()=>{for(let[b,c]of Object.entries(k)){var a;if(a=c.toggles,v.ema5===a.ema5&&v.ema13===a.ema13&&v.ema50===a.ema50&&v.ema200===a.ema200&&v.ema800===a.ema800&&v.emaCloud50===a.emaCloud50&&v.vwapSession===a.vwapSession&&v.dailyOpen===a.dailyOpen)return b}return null},[v]);return(0,g.useMemo)(()=>"1m"===c||"5m"===c||"15m"===c||"1h"===c||"4h"===c||"1d"===c?c:"15m",[c]),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{ref:f,style:{width:"100%",height:520}}),(0,d.jsxs)("div",{style:{marginTop:8,fontSize:12,color:"var(--muted)",display:"flex",justifyContent:"space-between",gap:8,flexWrap:"wrap"},children:[(0,d.jsx)("span",{children:"Chart engine: lightweight-charts"}),(0,d.jsx)("span",{children:"error"===h?`Chart error: ${l}`:l})]}),(0,d.jsxs)("div",{style:{marginTop:8,display:"flex",gap:14,flexWrap:"wrap",fontSize:12},children:[(0,d.jsxs)("label",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[(0,d.jsx)("input",{type:"checkbox",checked:r,onChange:a=>s(a.target.checked)}),"Show Up Signals"]}),(0,d.jsxs)("label",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[(0,d.jsx)("input",{type:"checkbox",checked:t,onChange:a=>u(a.target.checked)}),"Show Down Signals"]})]}),(0,d.jsxs)("div",{style:{marginTop:8,display:"flex",flexWrap:"wrap",gap:10,fontSize:12},children:[(0,d.jsx)("span",{style:{opacity:.8},children:"Indicators:"}),[{key:"ema5",label:"EMA 5"},{key:"ema13",label:"EMA 13"},{key:"ema50",label:"EMA 50"},{key:"ema200",label:"EMA 200"},{key:"ema800",label:"EMA 800"},{key:"emaCloud50",label:"EMA 50 Cloud"},{key:"vwapSession",label:"Session VWAP"},{key:"dailyOpen",label:"Daily Open"}].map(a=>(0,d.jsxs)("label",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[(0,d.jsx)("input",{type:"checkbox",checked:v[a.key],onChange:b=>w(c=>({...c,[a.key]:b.target.checked}))}),a.label]},a.key))]}),(0,d.jsxs)("div",{style:{marginTop:8,display:"flex",flexWrap:"wrap",gap:8,alignItems:"center"},children:[(0,d.jsx)("span",{style:{fontSize:12,opacity:.8},children:"Presets:"}),Object.keys(k).map(a=>{let b=k[a],c=x===a;return(0,d.jsx)("button",{type:"button",className:"btn",onClick:()=>w(b.toggles),style:{padding:"4px 10px",fontSize:12,minHeight:0,borderColor:c?"rgba(56,189,248,.95)":void 0,color:c?"#38bdf8":void 0},children:b.label},a)})]})]})}let m=process.env.NEXT_PUBLIC_API_URL??process.env.API_URL??process.env.API_BASE_URL??"http://localhost:4000",n=["1m","5m","15m","1h","4h","1d"],o=[{value:"quantity",title:"Quantity",description:"Quantity of the futures position, measured in base asset.",unit:"BASE"},{value:"cost",title:"Cost",description:"Margin amount used for the trade.",unit:"USDT"},{value:"value",title:"Value",description:"Notional value of the position.",unit:"USDT"}];function p(a){if(a instanceof TypeError){let b=String(a.message??"");if(b.includes("NetworkError")||b.includes("Failed to fetch"))return`API connection failed (${m}). Check if apps/api is running on port 4000.`}return a instanceof i.hD?`${a.message} (HTTP ${a.status})`:a&&"object"==typeof a&&"message"in a?String(a.message):String(a)}function q(a,b=2){return null==a||Number.isNaN(a)?"-":Number(a).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:b})}function r(a,b){return null!=a&&Number.isFinite(a)?Number(a).toFixed(b):"n/a"}function s(){let a=(0,h.useRouter)(),b=(0,h.useSearchParams)();(0,g.useMemo)(()=>m.startsWith("https://")?`wss://${m.slice(8)}`:m.startsWith("http://")?`ws://${m.slice(7)}`:m,[]);let[c,e]=(0,g.useState)([]),[j,k]=(0,g.useState)([]),[s,t]=(0,g.useState)(""),[u,v]=(0,g.useState)("BTCUSDT"),[w,x]=(0,g.useState)("15m"),[y,z]=(0,g.useState)(null),[A,B]=(0,g.useState)([]),[C,D]=(0,g.useState)([]),[E,F]=(0,g.useState)(null),[G,H]=(0,g.useState)("limit"),[I,J]=(0,g.useState)("isolated"),[K,L]=(0,g.useState)("open"),[M,N]=(0,g.useState)("10"),[O,P]=(0,g.useState)("0.001"),[Q,R]=(0,g.useState)(0),[S,T]=(0,g.useState)("quantity"),[U,V]=(0,g.useState)("quantity"),[W,X]=(0,g.useState)(!1),[Y,Z]=(0,g.useState)(""),[$,_]=(0,g.useState)(!1),[aa,ab]=(0,g.useState)(""),[ac,ad]=(0,g.useState)(""),[ae,af]=(0,g.useState)(!0),[ag,ah]=(0,g.useState)(null),[ai,aj]=(0,g.useState)(null),[ak,al]=(0,g.useState)(null),[am,an]=(0,g.useState)(!1),[ao,ap]=(0,g.useState)(!1),[aq,ar]=(0,g.useState)(null),[as,at]=(0,g.useState)(null),[au,av]=(0,g.useState)(!0);(0,g.useRef)(null),(0,g.useRef)(null),(0,g.useRef)(null);let aw=(0,g.useMemo)(()=>c.find(a=>a.id===s)??null,[c,s]),ax=(0,g.useMemo)(()=>j.find(a=>a.symbol===u)??null,[j,u]),ay=aq?.marketType==="spot"&&"down"===aq.signal,az=(0,g.useMemo)(()=>{let a=Number(M);return Number.isFinite(a)&&a>0?a:null},[M]),aA=(0,g.useMemo)(()=>{let a=E?.mark??E?.last??null;return null!==a&&Number.isFinite(a)&&a>0?a:null},[E]),aB=(0,g.useMemo)(()=>{let a=y?.availableMargin??null;if(null===a||!Number.isFinite(a)||a<=0||!az||!aA)return null;let b=a*az/aA;if(!Number.isFinite(b)||b<=0)return null;let c=ax?.stepSize??null;return null!==c&&Number.isFinite(c)&&c>0?Math.floor(b/c)*c:b},[y,az,aA,ax]),aC=(0,g.useMemo)(()=>u.endsWith("USDT")&&u.slice(0,-4)||u,[u]),aD=(0,g.useMemo)(()=>o.find(a=>a.value===S)??o[0],[S]),aE="quantity"===S?aC:"USDT",aF=(0,g.useMemo)(()=>{let a=Number(O);return Number.isFinite(a)&&a>0?a:null},[O]),aG=(0,g.useMemo)(()=>{if("limit"===G){let a=Number(Y);return Number.isFinite(a)&&a>0?a:null}return aA},[G,Y,aA]),aH=(0,g.useMemo)(()=>null===aF?null:"quantity"===S?aF:aG&&Number.isFinite(aG)&&!(aG<=0)?"cost"===S?az&&Number.isFinite(az)&&!(az<=0)?aF*az/aG:null:aF/aG:null,[az,aG,S,aF]),aI=(0,g.useMemo)(()=>{if(null===aF)return null;if("cost"===S)return aF;if("value"===S)return az&&Number.isFinite(az)&&!(az<=0)?aF/az:null;if(!aH||!aG)return null;let a=aH*aG;return!Number.isFinite(a)||a<=0?null:az&&Number.isFinite(az)&&!(az<=0)?a/az:a},[az,aH,aG,S,aF]),aJ=(0,g.useMemo)(()=>{let a=y?.availableMargin??null;return null===a||!Number.isFinite(a)||a<=0?null:"quantity"===S?aB:"cost"===S?a:az&&Number.isFinite(az)&&!(az<=0)?a*az:null},[aB,az,S,y]),aK=(0,g.useMemo)(()=>{if(!aG||!az)return{long:null,short:null};let a="isolated"===I?.004:.005,b=aG*(1-1/az+a),c=aG*(1+1/az-a);return{long:Number.isFinite(b)&&b>0?b:null,short:Number.isFinite(c)&&c>0?c:null}},[I,az,aG]);async function aL(a){try{await (0,i.$P)("/api/trading/settings",a)}catch{}}async function aM(a,b){if(a){ah(null),aj(null);try{let c=await (0,i.Vg)(`/api/symbols?exchangeAccountId=${encodeURIComponent(a)}`),d=c.items??[];k(d);let e=(b??u).trim().toUpperCase(),f=c.defaultSymbol??d[0]?.symbol??"BTCUSDT",g=d.some(a=>a.symbol===e)?e:f;v(g);let[h,j,l]=await Promise.allSettled([(0,i.Vg)(`/api/account/summary?exchangeAccountId=${encodeURIComponent(a)}`),(0,i.Vg)(`/api/positions?exchangeAccountId=${encodeURIComponent(a)}&symbol=${encodeURIComponent(g)}`),(0,i.Vg)(`/api/orders/open?exchangeAccountId=${encodeURIComponent(a)}&symbol=${encodeURIComponent(g)}`)]),m=[];"fulfilled"===h.status?z(h.value):m.push(`account summary (${p(h.reason)})`),"fulfilled"===j.status?B(j.value.items??[]):(B([]),m.push(`positions (${p(j.reason)})`)),"fulfilled"===l.status?D(l.value.items??[]):(D([]),m.push(`open orders (${p(l.reason)})`)),m.length>0?aj(`Partial data unavailable: ${m.join(", ")}`):aj(null),await aL({exchangeAccountId:a,symbol:g,timeframe:w}),ah(null)}catch(a){ah(p(a))}}}async function aN(a,b){let[c,d,e]=await Promise.allSettled([(0,i.Vg)(`/api/positions?exchangeAccountId=${encodeURIComponent(a)}&symbol=${encodeURIComponent(b)}`),(0,i.Vg)(`/api/orders/open?exchangeAccountId=${encodeURIComponent(a)}&symbol=${encodeURIComponent(b)}`),(0,i.Vg)(`/api/account/summary?exchangeAccountId=${encodeURIComponent(a)}`)]);"fulfilled"===c.status&&B(c.value.items??[]),"fulfilled"===d.status&&D(d.value.items??[]),"fulfilled"===e.status&&z(e.value)}async function aO(){if(!s)return;let a=Number(M);if(!Number.isFinite(a)||a<1||a>125)return void al("Leverage must be between 1 and 125.");al(null),ap(!0);try{await (0,i.$P)("/api/account/leverage",{exchangeAccountId:s,symbol:u,leverage:Math.trunc(a),marginMode:I})}catch(a){al(p(a))}finally{ap(!1)}}async function aP(a){if(!s)return;let b=Number(O),c=Number(Y),d=Number(M),e=Number(aa),f=Number(ac);if(!Number.isFinite(b)||b<=0)return void al("Quantity must be greater than 0.");if(!aH||!Number.isFinite(aH)||aH<=0)return void al("Unable to derive order quantity for selected unit.");let g=ax?.stepSize??null,h=ax?.minQty??null,j=ax?.maxQty??null,k=aH;if(null!==g&&Number.isFinite(g)&&g>0&&(k=Math.floor(k/g)*g),null!==h&&Number.isFinite(h)&&h>0&&k<h)return void al(`Quantity is below minimum (${h}).`);if(null!==j&&Number.isFinite(j)&&j>0&&k>j&&(k=j),"limit"===G&&(!Number.isFinite(c)||c<=0))return void al("Limit orders require a valid price.");if(!Number.isFinite(d)||d<1||d>125)return void al("Leverage must be between 1 and 125.");if($&&aa.trim().length>0&&(!Number.isFinite(e)||e<=0))return void al("Take profit must be greater than 0.");if($&&ac.trim().length>0&&(!Number.isFinite(f)||f<=0))return void al("Stop loss must be greater than 0.");al(null),an(!0);try{await (0,i.$P)("/api/orders",{exchangeAccountId:s,symbol:u,type:G,side:a,qty:k,price:"limit"===G?c:void 0,takeProfitPrice:$&&aa.trim().length>0?e:void 0,stopLossPrice:$&&ac.trim().length>0?f:void 0,leverage:Math.trunc(d),marginMode:I,reduceOnly:"close"===K}),await aN(s,u),"limit"===G&&Z("")}catch(a){al(p(a))}finally{an(!1)}}async function aQ(a){if(s){al(null);try{await (0,i.$P)("/api/positions/close",{exchangeAccountId:s,symbol:u,side:a}),await aN(s,u)}catch(a){al(p(a))}}}async function aR(a){if(s){al(null);try{await (0,i.$P)("/api/orders/cancel",{exchangeAccountId:s,orderId:a,symbol:u}),await aN(s,u)}catch(a){al(p(a))}}}async function aS(){if(s){al(null);try{await (0,i.$P)(`/api/orders/cancel-all?exchangeAccountId=${encodeURIComponent(s)}&symbol=${encodeURIComponent(u)}`,{}),await aN(s,u)}catch(a){al(p(a))}}}return(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"dashboardHeader",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h2",{style:{margin:0},children:"Manual Trading Desk"}),(0,d.jsx)("div",{style:{fontSize:13,color:"var(--muted)"},children:"TradingView + futures order controls."})]}),(0,d.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[(0,d.jsx)(f(),{href:"/dashboard",className:"btn",children:"Dashboard"}),(0,d.jsx)(f(),{href:s?`/bots?exchangeAccountId=${encodeURIComponent(s)}`:"/bots",className:"btn",children:"Bots"})]})]}),ag?(0,d.jsxs)("div",{className:"card",style:{padding:12,borderColor:"#ef4444",marginBottom:12},children:[(0,d.jsx)("strong",{children:"Error:"})," ",ag,(0,d.jsx)("div",{style:{marginTop:8},children:(0,d.jsx)("button",{className:"btn",onClick:()=>{s&&aM(s,u)},children:"Retry"})})]}):null,ak?(0,d.jsxs)("div",{className:"card",style:{padding:12,borderColor:"#ef4444",marginBottom:12},children:[(0,d.jsx)("strong",{children:"Action failed:"})," ",ak]}):null,ai?(0,d.jsxs)("div",{className:"card",style:{padding:12,borderColor:"#f59e0b",marginBottom:12},children:[(0,d.jsx)("strong",{children:"Warning:"})," ",ai]}):null,aq?(0,d.jsxs)("div",{className:"card",style:{padding:12,borderColor:"#3b82f6",marginBottom:12},children:[(0,d.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",gap:8,flexWrap:"wrap",alignItems:"center"},children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("strong",{children:"Prediction Context"}),(0,d.jsxs)("div",{style:{fontSize:12,color:"var(--muted)",marginTop:4},children:[aq.symbol," \xb7 ",aq.marketType," \xb7 ",aq.timeframe," \xb7 ",function(a){if(!Number.isFinite(a))return"-";let b=Math.max(0,Math.min(100,a<=1?100*a:a));return`${b.toFixed(1)}%`}(aq.confidence)," \xb7"," ",new Date(aq.tsCreated).toLocaleString()]}),(0,d.jsxs)("div",{style:{fontSize:12,color:"var(--muted)",marginTop:2},children:["Signal: ",aq.signal," \xb7 Side: ",aq.side??"manual","number"==typeof aq.expectedMovePct?` \xb7 Move: ${aq.expectedMovePct.toFixed(2)}%`:""]}),aq.leverage?(0,d.jsxs)("div",{style:{fontSize:12,color:"var(--muted)",marginTop:2},children:["Prefill leverage: ",aq.leverage,"x"]}):null]}),(0,d.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[(0,d.jsx)("button",{className:"btn",type:"button",onClick:()=>av(a=>!a),children:au?"Hide context":"Show context"}),(0,d.jsx)(f(),{href:"/predictions",className:"btn",children:"Back to Prediction"}),(0,d.jsx)("button",{className:"btn",onClick:function(){ar(null),H("limit"),J("isolated"),L("open"),N("10"),T("quantity"),V("quantity"),P("0.001"),R(0),Z(""),_(!1),ab(""),ad(""),at(null);let c=new URLSearchParams(b.toString());c.delete("prefill"),c.delete("predictionId"),!c.get("exchangeAccountId")&&s&&c.set("exchangeAccountId",s);let d=c.toString()?`/trade?${c.toString()}`:"/trade";a.replace(d)},type:"button",children:"Clear Prefill"})]})]}),(0,d.jsxs)("div",{style:{marginTop:8,fontSize:12,color:"var(--muted)"},children:["Prediction ID: ",aq.predictionId]}),as?(0,d.jsx)("div",{style:{marginTop:8,fontSize:12,color:"#f59e0b"},children:as}):null,au?(0,d.jsxs)("div",{style:{marginTop:10,display:"grid",gap:10},children:[aq.tags?.length?(0,d.jsx)("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:aq.tags.map(a=>(0,d.jsx)("span",{className:"badge",children:a},a))}):null,aq.explanation?(0,d.jsxs)("details",{children:[(0,d.jsx)("summary",{style:{cursor:"pointer",fontSize:12},children:"AI explanation"}),(0,d.jsx)("div",{style:{marginTop:6,fontSize:12},children:aq.explanation})]}):null,(0,d.jsxs)("div",{style:{display:"grid",gap:8,gridTemplateColumns:"repeat(auto-fit,minmax(180px,1fr))"},children:[(0,d.jsxs)("div",{className:"card",style:{margin:0,padding:8},children:[(0,d.jsx)("div",{style:{fontSize:11,color:"var(--muted)"},children:"RSI (14)"}),(0,d.jsx)("div",{style:{fontWeight:700},children:r(aq.indicators?.rsi_14,1)})]}),(0,d.jsxs)("div",{className:"card",style:{margin:0,padding:8},children:[(0,d.jsx)("div",{style:{fontSize:11,color:"var(--muted)"},children:"MACD hist"}),(0,d.jsx)("div",{style:{fontWeight:700},children:r(aq.indicators?.macd?.hist,4)}),(0,d.jsxs)("div",{style:{fontSize:11,color:"var(--muted)",marginTop:2},children:["line ",r(aq.indicators?.macd?.line,4)," / signal ",r(aq.indicators?.macd?.signal,4)]})]}),(0,d.jsxs)("div",{className:"card",style:{margin:0,padding:8},children:[(0,d.jsx)("div",{style:{fontSize:11,color:"var(--muted)"},children:"BB width% / pos"}),(0,d.jsxs)("div",{style:{fontWeight:700},children:[r(aq.indicators?.bb?.width_pct,2)," / ",r(aq.indicators?.bb?.pos,3)]})]}),(0,d.jsxs)("div",{className:"card",style:{margin:0,padding:8},children:[(0,d.jsx)("div",{style:{fontSize:11,color:"var(--muted)"},children:"VWAP dist%"}),(0,d.jsx)("div",{style:{fontWeight:700},children:r(aq.indicators?.vwap?.dist_pct,2)}),(0,d.jsxs)("div",{style:{fontSize:11,color:"var(--muted)",marginTop:2},children:["mode ",aq.indicators?.vwap?.mode??"n/a"]})]}),(0,d.jsxs)("div",{className:"card",style:{margin:0,padding:8},children:[(0,d.jsx)("div",{style:{fontSize:11,color:"var(--muted)"},children:"ADX / +DI / -DI"}),(0,d.jsxs)("div",{style:{fontWeight:700},children:[r(aq.indicators?.adx?.adx_14,1)," / ",r(aq.indicators?.adx?.plus_di_14,1)," / ",r(aq.indicators?.adx?.minus_di_14,1)]})]}),(0,d.jsxs)("div",{className:"card",style:{margin:0,padding:8},children:[(0,d.jsx)("div",{style:{fontSize:11,color:"var(--muted)"},children:"StochRSI %K / %D / value"}),(0,d.jsxs)("div",{style:{fontWeight:700},children:[r(aq.indicators?.stochrsi?.k,1)," / ",r(aq.indicators?.stochrsi?.d,1)," / ",r(aq.indicators?.stochrsi?.value,1)]})]}),(0,d.jsxs)("div",{className:"card",style:{margin:0,padding:8},children:[(0,d.jsx)("div",{style:{fontSize:11,color:"var(--muted)"},children:"Volume z / rel / trend%"}),(0,d.jsxs)("div",{style:{fontWeight:700},children:[r(aq.indicators?.volume?.vol_z,3)," / ",r(aq.indicators?.volume?.rel_vol,3)," / ",r(aq.indicators?.volume?.vol_trend,2)]}),(0,d.jsxs)("div",{style:{fontSize:11,color:"var(--muted)",marginTop:2},children:["EMA ",r(aq.indicators?.volume?.vol_ema_fast,2)," / ",r(aq.indicators?.volume?.vol_ema_slow,2)]})]}),(0,d.jsxs)("div",{className:"card",style:{margin:0,padding:8},children:[(0,d.jsx)("div",{style:{fontSize:11,color:"var(--muted)"},children:"FVG open bull / bear"}),(0,d.jsxs)("div",{style:{fontWeight:700},children:[r(aq.indicators?.fvg?.open_bullish_count,0)," / ",r(aq.indicators?.fvg?.open_bearish_count,0)]}),(0,d.jsxs)("div",{style:{fontSize:11,color:"var(--muted)",marginTop:2},children:["bull ",r(aq.indicators?.fvg?.nearest_bullish_gap?.dist_pct,2),"% \xb7 bear ",r(aq.indicators?.fvg?.nearest_bearish_gap?.dist_pct,2),"%"]})]})]}),(0,d.jsxs)("div",{className:"card",style:{margin:0,padding:8},children:[(0,d.jsx)("div",{style:{fontSize:11,color:"var(--muted)",marginBottom:4},children:"Key drivers"}),aq.keyDrivers?.length?(0,d.jsx)("ul",{style:{margin:0,paddingLeft:18,fontSize:12},children:aq.keyDrivers.slice(0,5).map(a=>(0,d.jsxs)("li",{children:[(0,d.jsx)("strong",{children:a.name}),": ",String(a.value)]},a.name))}):(0,d.jsx)("div",{style:{fontSize:12,color:"var(--muted)"},children:"n/a"})]})]}):null]}):null,ae?(0,d.jsx)("div",{className:"card",style:{padding:16},children:"Loading trading desk…"}):0===c.length?(0,d.jsxs)("div",{className:"card",style:{padding:16},children:[(0,d.jsx)("div",{style:{fontWeight:700,marginBottom:8},children:"No exchange accounts available"}),(0,d.jsx)("div",{style:{color:"var(--muted)",marginBottom:12},children:"Add a Bitget account first to use manual trading."}),(0,d.jsx)(f(),{href:"/settings",className:"btn btnPrimary",children:"Add Exchange Account"})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("section",{className:"card",style:{padding:12,marginBottom:12},children:(0,d.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(200px,1fr))",gap:10},children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{style:{fontSize:12,color:"var(--muted)",marginBottom:4},children:"Exchange account"}),(0,d.jsx)("select",{className:"input",value:s,onChange:a=>{let b=a.target.value;t(b),aL({exchangeAccountId:b})},children:c.map(a=>(0,d.jsxs)("option",{value:a.id,children:[a.exchange.toUpperCase()," - ",a.label]},a.id))})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{style:{fontSize:12,color:"var(--muted)",marginBottom:4},children:"Symbol"}),(0,d.jsx)("select",{className:"input",value:u,onChange:a=>{let b=a.target.value;v(b),aN(s,b),aL({symbol:b})},children:j.map(a=>(0,d.jsxs)("option",{value:a.symbol,children:[a.symbol," ",a.tradable?"":"(restricted)"]},a.symbol))})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{style:{fontSize:12,color:"var(--muted)",marginBottom:4},children:"Timeframe"}),(0,d.jsx)("select",{className:"input",value:w,onChange:a=>{let b=a.target.value;x(b),aL({timeframe:b})},children:n.map(a=>(0,d.jsx)("option",{value:a,children:a},a))})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{style:{fontSize:12,color:"var(--muted)",marginBottom:4},children:"Account"}),(0,d.jsxs)("div",{className:"card",style:{padding:10,minHeight:44},children:["Eq: ",q(y?.equity)," | Avail: ",q(y?.availableMargin)]})]})]})}),(0,d.jsxs)("section",{className:"tradeDeskGrid",children:[(0,d.jsxs)("article",{className:"card",style:{padding:10,minHeight:620},children:[(0,d.jsxs)("div",{style:{marginBottom:8,fontWeight:700},children:[u," ",ax?.status?`- ${ax.status}`:""]}),(0,d.jsx)(l,{exchangeAccountId:s,symbol:u,timeframe:w,prefill:aq})]}),(0,d.jsxs)("article",{className:"card",style:{padding:10,minHeight:620},children:[(0,d.jsx)("div",{style:{fontWeight:700,marginBottom:8},children:"Order Entry"}),(0,d.jsxs)("div",{className:"tradeOrderPanel",children:[(0,d.jsxs)("div",{className:"tradeOrderTopRow",children:[(0,d.jsxs)("div",{className:"tradeOrderModeSwitch",children:[(0,d.jsx)("button",{className:`tradeOrderModeBtn ${"isolated"===I?"tradeOrderModeBtnActive":""}`,onClick:()=>{J("isolated"),aL({marginMode:"isolated"})},type:"button",children:"Isolated"}),(0,d.jsx)("button",{className:`tradeOrderModeBtn ${"cross"===I?"tradeOrderModeBtnActive":""}`,onClick:()=>{J("cross"),aL({marginMode:"cross"})},type:"button",children:"Cross"})]}),(0,d.jsxs)("div",{className:"tradeOrderLeverageGroup",children:[(0,d.jsx)("input",{className:"tradeOrderLeverageInput",type:"number",min:1,max:125,step:1,value:M,onChange:a=>N(a.target.value)}),(0,d.jsx)("button",{className:"tradeOrderApplyBtn",disabled:ao,onClick:()=>void aO(),type:"button",children:ao?"...":"Apply"})]})]}),(0,d.jsxs)("div",{className:"tradeOrderEntryMode",children:[(0,d.jsx)("button",{className:`tradeOrderEntryModeBtn ${"open"===K?"tradeOrderEntryModeBtnActive":""}`,onClick:()=>L("open"),type:"button",children:"Open"}),(0,d.jsx)("button",{className:`tradeOrderEntryModeBtn ${"close"===K?"tradeOrderEntryModeBtnActive":""}`,onClick:()=>L("close"),type:"button",children:"Close"})]}),(0,d.jsxs)("div",{className:"tradeOrderTypeTabs",children:[(0,d.jsx)("button",{className:`tradeOrderTypeTab ${"limit"===G?"tradeOrderTypeTabActive":""}`,onClick:()=>H("limit"),type:"button",children:"Limit"}),(0,d.jsx)("button",{className:`tradeOrderTypeTab ${"market"===G?"tradeOrderTypeTabActive":""}`,onClick:()=>H("market"),type:"button",children:"Market"}),(0,d.jsx)("button",{className:"tradeOrderTypeTab tradeOrderTypeTabMuted",type:"button",disabled:!0,children:"Post only"})]}),(0,d.jsxs)("div",{className:"tradeOrderMetaRow",children:[(0,d.jsx)("span",{children:"Available"}),(0,d.jsxs)("strong",{children:[q(y?.availableMargin,3)," USDT"]})]}),"limit"===G?(0,d.jsxs)("label",{className:"tradeOrderField",children:[(0,d.jsx)("span",{children:"Price"}),(0,d.jsxs)("div",{className:"tradeOrderInputRow",children:[(0,d.jsx)("input",{className:"tradeOrderInput",value:Y,onChange:a=>Z(a.target.value),placeholder:E?.last?String(E.last):"0.0"}),(0,d.jsx)("button",{className:"tradeOrderMiniBtn",type:"button",onClick:()=>{let a=E?.last??E?.mark;a&&Number.isFinite(a)&&Z(String(a))},children:"BBO"})]})]}):null,(0,d.jsxs)("label",{className:"tradeOrderField",children:[(0,d.jsx)("span",{children:aD.title}),(0,d.jsxs)("div",{className:"tradeOrderInputRow",children:[(0,d.jsx)("input",{className:"tradeOrderInput",value:O,onChange:a=>P(a.target.value),placeholder:"quantity"===S?"0.001":"10"}),(0,d.jsx)("button",{type:"button",className:"tradeOrderUnitBadge",onClick:()=>{V(S),X(!0)},children:aE})]})]}),(0,d.jsx)("input",{className:"tradeOrderSlider",type:"range",min:0,max:100,step:25,value:Q,onChange:a=>(function(a){let b=Math.max(0,Math.min(100,a));if(R(b),!aJ||aJ<=0)return;let c=aJ*b/100;if("quantity"!==S)return!Number.isFinite(c)||c<=0?void P(""):void P(c.toFixed(4).replace(/\.?0+$/,""));let d=ax?.stepSize??null,e=ax?.minQty??null,f=c;if(null!==d&&Number.isFinite(d)&&d>0&&(f=Math.floor(c/d)*d),b>0&&null!==e&&Number.isFinite(e)&&e>0&&(f=Math.max(f,e)),f>0&&Number.isFinite(f)){let a=null!==d&&d>0&&Number.isFinite(d)?Math.min(8,String(d).split(".")[1]?.length??0):6;P(f.toFixed(a).replace(/\.?0+$/,""))}})(Number(a.target.value))}),(0,d.jsxs)("div",{className:"tradeOrderDualStats",children:[(0,d.jsxs)("div",{className:"tradeOrderDualRow",children:[(0,d.jsx)("span",{children:"Position size"}),(0,d.jsxs)("strong",{children:[(0,d.jsx)("span",{className:"tradeOrderValueLong",children:q(aH,4)}),(0,d.jsx)("span",{className:"tradeOrderValueSlash",children:" / "}),(0,d.jsx)("span",{className:"tradeOrderValueShort",children:q(aH,4)}),(0,d.jsxs)("span",{className:"tradeOrderValueUnit",children:[" ",aC]})]})]}),(0,d.jsxs)("div",{className:"tradeOrderDualRow",children:[(0,d.jsx)("span",{children:"Cost"}),(0,d.jsxs)("strong",{children:[(0,d.jsx)("span",{className:"tradeOrderValueLong",children:q(aI,4)}),(0,d.jsx)("span",{className:"tradeOrderValueSlash",children:" / "}),(0,d.jsx)("span",{className:"tradeOrderValueShort",children:q(aI,4)}),(0,d.jsx)("span",{className:"tradeOrderValueUnit",children:" USDT"})]})]}),(0,d.jsxs)("div",{className:"tradeOrderDualRow",children:[(0,d.jsx)("span",{children:"Est. liq. price"}),(0,d.jsxs)("strong",{children:[(0,d.jsx)("span",{className:"tradeOrderValueLong",children:q(aK.long,1)}),(0,d.jsx)("span",{className:"tradeOrderValueSlash",children:" / "}),(0,d.jsx)("span",{className:"tradeOrderValueShort",children:q(aK.short,1)})]})]})]}),(0,d.jsxs)("label",{className:"tradeOrderCheckRow",children:[(0,d.jsx)("input",{type:"checkbox",checked:$,onChange:a=>_(a.target.checked)}),(0,d.jsx)("span",{children:"TP/SL"})]}),$?(0,d.jsxs)("div",{className:"tradeOrderTpSlGrid",children:[(0,d.jsxs)("label",{className:"tradeOrderField",children:[(0,d.jsx)("span",{children:"Take Profit"}),(0,d.jsx)("input",{className:"tradeOrderInput",value:aa,onChange:a=>ab(a.target.value),placeholder:"optional"})]}),(0,d.jsxs)("label",{className:"tradeOrderField",children:[(0,d.jsx)("span",{children:"Stop Loss"}),(0,d.jsx)("input",{className:"tradeOrderInput",value:ac,onChange:a=>ad(a.target.value),placeholder:"optional"})]})]}):null,(0,d.jsxs)("div",{className:"tradeOrderMetaRow",children:[(0,d.jsx)("span",{children:"Time in force"}),(0,d.jsx)("strong",{children:"limit"===G?"GTC":"IOC"})]}),aq?(0,d.jsxs)("div",{className:"tradeOrderMetaRow",children:[(0,d.jsx)("span",{children:"Prefilled side"}),(0,d.jsx)("strong",{children:aq.side?aq.side.toUpperCase():"Manual selection required"})]}):null,(0,d.jsxs)("div",{className:"tradeOrderActionGrid",children:[(0,d.jsxs)("button",{className:"btn btnStart",style:aq?.side==="long"?{boxShadow:"0 0 0 2px rgba(16,185,129,.45) inset"}:void 0,disabled:am,onClick:()=>void aP("long"),type:"button",children:["open"===K?"Open Long":"Close Short",aq?.side==="long"?" (Suggested)":""]}),(0,d.jsxs)("button",{className:"btn btnStop",style:aq?.side==="short"?{boxShadow:"0 0 0 2px rgba(239,68,68,.45) inset"}:void 0,disabled:am||ay,onClick:()=>void aP("short"),type:"button",children:["open"===K?"Open Short":"Close Long",aq?.side==="short"?" (Suggested)":""]})]}),(0,d.jsxs)("div",{className:"tradeOrderMetaRow",children:[(0,d.jsx)("span",{children:"Max"}),(0,d.jsx)("strong",{children:aJ?`${q(aJ,4)} ${aE}`:"-"})]}),(0,d.jsxs)("button",{className:"btn",onClick:()=>void aS(),type:"button",children:["Cancel All (",u,")"]}),(0,d.jsx)("div",{className:"tradeOrderDivider"}),(0,d.jsx)("div",{className:"tradeOrderInfoTitle",children:"Account"}),(0,d.jsxs)("div",{className:"tradeOrderInfoGrid",children:[(0,d.jsxs)("div",{className:"tradeOrderInfoRow",children:[(0,d.jsx)("span",{children:"Margin"}),(0,d.jsx)("strong",{children:q(y?.availableMargin,3)})]}),(0,d.jsxs)("div",{className:"tradeOrderInfoRow",children:[(0,d.jsx)("span",{children:"Equity"}),(0,d.jsx)("strong",{children:q(y?.equity,3)})]}),(0,d.jsxs)("div",{className:"tradeOrderInfoRow",children:[(0,d.jsx)("span",{children:"Last"}),(0,d.jsx)("strong",{children:q(E?.last,4)})]}),(0,d.jsxs)("div",{className:"tradeOrderInfoRow",children:[(0,d.jsx)("span",{children:"Mark"}),(0,d.jsx)("strong",{children:q(E?.mark,4)})]}),(0,d.jsxs)("div",{className:"tradeOrderInfoRow",children:[(0,d.jsx)("span",{children:"Bid / Ask"}),(0,d.jsxs)("strong",{children:[q(E?.bid,4)," / ",q(E?.ask,4)]})]})]}),(0,d.jsx)("div",{className:"tradeOrderSelectedAccount",children:aw?`${aw.exchange.toUpperCase()} - ${aw.label}`:"-"})]})]})]}),(0,d.jsxs)("section",{className:"card",style:{padding:12,marginTop:12},children:[(0,d.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10,flexWrap:"wrap",gap:8},children:[(0,d.jsx)("div",{style:{fontWeight:700},children:"Positions"}),(0,d.jsxs)("div",{style:{fontSize:12,color:"var(--muted)"},children:["Symbol filter: ",u]})]}),(0,d.jsx)("div",{style:{overflowX:"auto"},children:(0,d.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{style:{textAlign:"left",color:"var(--muted)"},children:[(0,d.jsx)("th",{style:{padding:"8px 6px"},children:"Side"}),(0,d.jsx)("th",{style:{padding:"8px 6px"},children:"Size"}),(0,d.jsx)("th",{style:{padding:"8px 6px"},children:"Entry"}),(0,d.jsx)("th",{style:{padding:"8px 6px"},children:"Mark"}),(0,d.jsx)("th",{style:{padding:"8px 6px"},children:"PnL"}),(0,d.jsx)("th",{style:{padding:"8px 6px"},children:"Action"})]})}),(0,d.jsx)("tbody",{children:0===A.length?(0,d.jsx)("tr",{children:(0,d.jsx)("td",{colSpan:6,style:{padding:10,color:"var(--muted)"},children:"No open positions."})}):A.map((a,b)=>(0,d.jsxs)("tr",{style:{borderTop:"1px solid rgba(255,255,255,.06)"},children:[(0,d.jsx)("td",{style:{padding:"8px 6px",color:"long"===a.side?"#34d399":"#f87171"},children:a.side.toUpperCase()}),(0,d.jsx)("td",{style:{padding:"8px 6px"},children:q(a.size,6)}),(0,d.jsx)("td",{style:{padding:"8px 6px"},children:q(a.entryPrice,4)}),(0,d.jsx)("td",{style:{padding:"8px 6px"},children:q(a.markPrice,4)}),(0,d.jsx)("td",{style:{padding:"8px 6px",color:(a.unrealizedPnl??0)>=0?"#34d399":"#f87171"},children:q(a.unrealizedPnl,2)}),(0,d.jsx)("td",{style:{padding:"8px 6px"},children:(0,d.jsx)("button",{className:"btn",onClick:()=>void aQ(a.side),children:"Close"})})]},`${a.side}_${b}`))})]})})]}),(0,d.jsxs)("section",{className:"card",style:{padding:12,marginTop:12},children:[(0,d.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10,flexWrap:"wrap",gap:8},children:[(0,d.jsx)("div",{style:{fontWeight:700},children:"Open Orders"}),(0,d.jsx)("button",{className:"btn",onClick:()=>void aS(),children:"Cancel All"})]}),(0,d.jsx)("div",{style:{overflowX:"auto"},children:(0,d.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{style:{textAlign:"left",color:"var(--muted)"},children:[(0,d.jsx)("th",{style:{padding:"8px 6px"},children:"Order ID"}),(0,d.jsx)("th",{style:{padding:"8px 6px"},children:"Side"}),(0,d.jsx)("th",{style:{padding:"8px 6px"},children:"Type"}),(0,d.jsx)("th",{style:{padding:"8px 6px"},children:"Price"}),(0,d.jsx)("th",{style:{padding:"8px 6px"},children:"Qty"}),(0,d.jsx)("th",{style:{padding:"8px 6px"},children:"Status"}),(0,d.jsx)("th",{style:{padding:"8px 6px"},children:"Action"})]})}),(0,d.jsx)("tbody",{children:0===C.length?(0,d.jsx)("tr",{children:(0,d.jsx)("td",{colSpan:7,style:{padding:10,color:"var(--muted)"},children:"No open orders."})}):C.map(a=>(0,d.jsxs)("tr",{style:{borderTop:"1px solid rgba(255,255,255,.06)"},children:[(0,d.jsxs)("td",{style:{padding:"8px 6px"},children:[a.orderId.slice(0,12),"..."]}),(0,d.jsx)("td",{style:{padding:"8px 6px"},children:a.side??"-"}),(0,d.jsx)("td",{style:{padding:"8px 6px"},children:a.type??"-"}),(0,d.jsx)("td",{style:{padding:"8px 6px"},children:q(a.price,4)}),(0,d.jsx)("td",{style:{padding:"8px 6px"},children:q(a.qty,6)}),(0,d.jsx)("td",{style:{padding:"8px 6px"},children:a.status??"-"}),(0,d.jsx)("td",{style:{padding:"8px 6px"},children:(0,d.jsx)("button",{className:"btn",onClick:()=>void aR(a.orderId),children:"Cancel"})})]},a.orderId))})]})})]})]}),W?(0,d.jsx)("div",{className:"tradeModalBackdrop",onClick:()=>X(!1),children:(0,d.jsxs)("div",{className:"tradeModalCard",onClick:a=>a.stopPropagation(),children:[(0,d.jsxs)("div",{className:"tradeModalHeader",children:[(0,d.jsx)("h3",{children:"Futures unit setting"}),(0,d.jsx)("button",{type:"button",className:"tradeModalCloseBtn",onClick:()=>X(!1),"aria-label":"Close",children:"\xd7"})]}),(0,d.jsx)("div",{className:"tradeModalOptions",children:o.map(a=>{let b="BASE"===a.unit?aC:a.unit,c=U===a.value;return(0,d.jsxs)("button",{type:"button",className:`tradeModalOption ${c?"tradeModalOptionActive":""}`,onClick:()=>V(a.value),children:[(0,d.jsxs)("div",{className:"tradeModalOptionTitle",children:[a.title,"-",b]}),(0,d.jsx)("div",{className:"tradeModalOptionDescription",children:a.description})]},a.value)})}),(0,d.jsxs)("div",{className:"tradeModalActions",children:[(0,d.jsx)("button",{type:"button",className:"tradeModalSecondaryBtn",onClick:()=>X(!1),children:"Cancel"}),(0,d.jsx)("button",{type:"button",className:"tradeModalPrimaryBtn",onClick:()=>{T(U),R(0),P(""),X(!1)},children:"Confirm"})]})]})}):null]})}function t(){return(0,d.jsx)(g.Suspense,{fallback:(0,d.jsx)("div",{children:"Loading trade page…"}),children:(0,d.jsx)(s,{})})}},90717:(a,b,c)=>{c.r(b),c.d(b,{default:()=>d});let d=(0,c(25459).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/marioeuchner/Documents/GitHub/uTrade-Bots/apps/web/app/trade/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/marioeuchner/Documents/GitHub/uTrade-Bots/apps/web/app/trade/page.tsx","default")}};