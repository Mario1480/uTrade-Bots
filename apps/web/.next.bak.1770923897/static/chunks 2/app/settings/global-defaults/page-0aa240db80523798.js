(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[665],{2655:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var l=n(4568),a=n(9664),s=n.n(a),i=n(7620),c=n(2883);function r(){let[e,t]=(0,i.useState)(null),[n,a]=(0,i.useState)([]),[r,o]=(0,i.useState)("default"),[u,d]=(0,i.useState)("{}"),[f,h]=(0,i.useState)(""),[g,m]=(0,i.useState)("");function v(e){return e instanceof c.hD?"".concat(e.message," (HTTP ").concat(e.status,")"):(null==e?void 0:e.message)?String(e.message):String(e)}async function y(){try{let n=await (0,c.Vg)("/auth/me");t(n);let l=await (0,c.Vg)("/global-settings");if(a(l),l.length){var e;o(l[0].key),d(JSON.stringify(null!=(e=l[0].value)?e:{},null,2))}}catch(e){m(v(e))}}async function p(){h("saving..."),m("");try{let e=JSON.parse(u||"{}"),t=await (0,c.mu)("/global-settings/".concat(encodeURIComponent(r)),{value:e});h("saved"),setTimeout(()=>h(""),1200),a(e=>[...e.filter(e=>e.key!==t.key),t])}catch(e){h(""),m(v(e))}}(0,i.useEffect)(()=>{y()},[]);let S=!!(null==e?void 0:e.isSuperadmin);return(0,l.jsxs)("div",{style:{maxWidth:980},children:[(0,l.jsxs)("div",{style:{marginBottom:10,display:"flex",gap:8,flexWrap:"wrap"},children:[(0,l.jsx)(s(),{href:"/settings",className:"btn",children:"← Back to settings"}),(0,l.jsx)(s(),{href:"/",className:"btn",children:"← Back to dashboard"})]}),(0,l.jsx)("h2",{style:{marginTop:0},children:"Global Defaults"}),S?(0,l.jsx)("div",{className:"card",style:{padding:12},children:(0,l.jsxs)("div",{style:{display:"grid",gap:8},children:[(0,l.jsxs)("label",{style:{fontSize:13},children:["Key",(0,l.jsx)("input",{className:"input",value:r,onChange:e=>o(e.target.value)})]}),(0,l.jsxs)("label",{style:{fontSize:13},children:["JSON Value",(0,l.jsx)("textarea",{className:"input",style:{minHeight:160},value:u,onChange:e=>d(e.target.value)})]}),(0,l.jsx)("button",{className:"btn btnPrimary",onClick:p,children:"Save"}),f?(0,l.jsx)("div",{style:{fontSize:12,opacity:.7},children:f}):null]})}):(0,l.jsx)("div",{className:"card",style:{padding:12,fontSize:12,color:"var(--muted)"},children:"Superadmin only."}),g?(0,l.jsx)("div",{style:{fontSize:12,color:"#ff6b6b",marginTop:10},children:g}):null]})}},2811:(e,t,n)=>{Promise.resolve().then(n.bind(n,2655))},2883:(e,t,n)=>{"use strict";n.d(t,{$P:()=>f,Al:()=>g,GC:()=>m,Vg:()=>d,hD:()=>o,mu:()=>h});var l,a,s,i,c=n(7011);null!=(null!=(l=c.env.API_URL)?l:c.env.API_BASE_URL)||c.env.NEXT_PUBLIC_API_URL;let r=null!=(i=null!=(s=null!=(a=c.env.NEXT_PUBLIC_API_URL)?a:c.env.API_URL)?s:c.env.API_BASE_URL)?i:"http://localhost:4000";class o extends Error{constructor(e,t,n){super(e),this.status=t,this.payload=n}}async function u(e,t,n){let l={"Content-Type":"application/json"};if(!["GET","HEAD","OPTIONS"].includes(e)){let e=function(e){if("undefined"==typeof document)return null;let t=document.cookie.match(new RegExp("(^|; )".concat(e,"=([^;]*)")));return t?decodeURIComponent(t[2]):null}("mm_csrf");e&&(l["x-csrf-token"]=e)}let a=await fetch("".concat(r).concat(t),{method:e,headers:l,body:n?JSON.stringify(n):void 0,credentials:"include",cache:"no-store"});if(!a.ok){let n=null;try{n=await a.json()}catch(e){}throw new o((null==n?void 0:n.error)||(null==n?void 0:n.message)||"".concat(e," ").concat(t," failed (").concat(a.status,")"),a.status,n)}return a.json()}function d(e){return u("GET",e)}function f(e,t){return u("POST",e,t)}function h(e,t){return u("PUT",e,t)}function g(e){return u("DELETE",e)}function m(e){return u("DELETE",e)}}},e=>{e.O(0,[664,587,18,358],()=>e(e.s=2811)),_N_E=e.O()}]);