(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[14],{2883:(e,t,n)=>{"use strict";n.d(t,{$P:()=>h,Al:()=>v,GC:()=>m,Vg:()=>u,hD:()=>o,mu:()=>f});var s,i,l,a,r=n(7011);null!=(null!=(s=r.env.API_URL)?s:r.env.API_BASE_URL)||r.env.NEXT_PUBLIC_API_URL;let c=null!=(a=null!=(l=null!=(i=r.env.NEXT_PUBLIC_API_URL)?i:r.env.API_URL)?l:r.env.API_BASE_URL)?a:"http://localhost:4000";class o extends Error{constructor(e,t,n){super(e),this.status=t,this.payload=n}}async function d(e,t,n){let s={"Content-Type":"application/json"};if(!["GET","HEAD","OPTIONS"].includes(e)){let e=function(e){if("undefined"==typeof document)return null;let t=document.cookie.match(new RegExp("(^|; )".concat(e,"=([^;]*)")));return t?decodeURIComponent(t[2]):null}("mm_csrf");e&&(s["x-csrf-token"]=e)}let i=await fetch("".concat(c).concat(t),{method:e,headers:s,body:n?JSON.stringify(n):void 0,credentials:"include",cache:"no-store"});if(!i.ok){let n=null;try{n=await i.json()}catch(e){}throw new o((null==n?void 0:n.error)||(null==n?void 0:n.message)||"".concat(e," ").concat(t," failed (").concat(i.status,")"),i.status,n)}return i.json()}function u(e){return d("GET",e)}function h(e,t){return d("POST",e,t)}function f(e,t){return d("PUT",e,t)}function v(e){return d("DELETE",e)}function m(e){return d("DELETE",e)}},6032:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>c});var s=n(4568),i=n(9664),l=n.n(i),a=n(7620),r=n(2883);function c(){var e;let[t,n]=(0,a.useState)(null),[i,c]=(0,a.useState)([]),[o,d]=(0,a.useState)("");async function u(){try{let e=await (0,r.Vg)("/auth/me");n(e);let t=await (0,r.Vg)("/workspaces/".concat(e.workspaceId,"/audit?limit=100"));c(t)}catch(e){d(e instanceof r.hD?"".concat(e.message," (HTTP ").concat(e.status,")"):(null==e?void 0:e.message)?String(e.message):String(e))}}(0,a.useEffect)(()=>{u()},[]);let h=!!((null==t||null==(e=t.permissions)?void 0:e["audit.view"])||(null==t?void 0:t.isSuperadmin));return(0,s.jsxs)("div",{style:{maxWidth:980},children:[(0,s.jsxs)("div",{style:{marginBottom:10,display:"flex",gap:8,flexWrap:"wrap"},children:[(0,s.jsx)(l(),{href:"/settings",className:"btn",children:"← Back to settings"}),(0,s.jsx)(l(),{href:"/",className:"btn",children:"← Back to dashboard"})]}),(0,s.jsx)("h2",{style:{marginTop:0},children:"Audit Log"}),h?(0,s.jsx)("div",{className:"card",style:{padding:12},children:0===i.length?(0,s.jsx)("div",{style:{fontSize:12,color:"var(--muted)"},children:"No audit events yet."}):(0,s.jsx)("div",{style:{display:"grid",gap:8},children:i.map(e=>{var t;return(0,s.jsxs)("div",{className:"card",style:{padding:8},children:[(0,s.jsx)("div",{style:{fontSize:12,color:"var(--muted)"},children:e.createdAt}),(0,s.jsx)("div",{style:{fontWeight:700},children:e.action}),(0,s.jsxs)("div",{style:{fontSize:12,color:"var(--muted)"},children:[e.entityType," ",null!=(t=e.entityId)?t:""]}),e.meta?(0,s.jsx)("pre",{style:{marginTop:6,whiteSpace:"pre-wrap"},children:JSON.stringify(e.meta,null,2)}):null]},e.id)})})}):(0,s.jsx)("div",{className:"card",style:{padding:12,fontSize:12,color:"var(--muted)"},children:"You don’t have permission to view audit logs."}),o?(0,s.jsx)("div",{style:{fontSize:12,color:"#ff6b6b",marginTop:10},children:o}):null]})}},9018:(e,t,n)=>{Promise.resolve().then(n.bind(n,6032))}},e=>{e.O(0,[664,587,18,358],()=>e(e.s=9018)),_N_E=e.O()}]);