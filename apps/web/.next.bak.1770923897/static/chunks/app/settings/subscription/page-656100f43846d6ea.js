(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[586],{2883:(e,n,t)=>{"use strict";t.d(n,{$P:()=>h,Al:()=>f,GC:()=>v,Vg:()=>u,hD:()=>o,mu:()=>m});var s,i,l,a,r=t(7011);null!=(null!=(s=r.env.API_URL)?s:r.env.API_BASE_URL)||r.env.NEXT_PUBLIC_API_URL;let c=null!=(a=null!=(l=null!=(i=r.env.NEXT_PUBLIC_API_URL)?i:r.env.API_URL)?l:r.env.API_BASE_URL)?a:"http://localhost:4000";class o extends Error{constructor(e,n,t){super(e),this.status=n,this.payload=t}}async function d(e,n,t){let s={"Content-Type":"application/json"};if(!["GET","HEAD","OPTIONS"].includes(e)){let e=function(e){if("undefined"==typeof document)return null;let n=document.cookie.match(new RegExp("(^|; )".concat(e,"=([^;]*)")));return n?decodeURIComponent(n[2]):null}("mm_csrf");e&&(s["x-csrf-token"]=e)}let i=await fetch("".concat(c).concat(n),{method:e,headers:s,body:t?JSON.stringify(t):void 0,credentials:"include",cache:"no-store"});if(!i.ok){let t=null;try{t=await i.json()}catch(e){}throw new o((null==t?void 0:t.error)||(null==t?void 0:t.message)||"".concat(e," ").concat(n," failed (").concat(i.status,")"),i.status,t)}return i.json()}function u(e){return d("GET",e)}function h(e,n){return d("POST",e,n)}function m(e,n){return d("PUT",e,n)}function f(e){return d("DELETE",e)}function v(e){return d("DELETE",e)}},6206:(e,n,t)=>{Promise.resolve().then(t.bind(t,7700))},7700:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>c});var s=t(4568),i=t(9664),l=t.n(i),a=t(7620),r=t(2883);function c(){var e,n,t;let[i,c]=(0,a.useState)(!0),[o,d]=(0,a.useState)(!1),[u,h]=(0,a.useState)(null),[m,f]=(0,a.useState)(""),[v,x]=(0,a.useState)(""),[g,p]=(0,a.useState)(null);function y(e){if(e instanceof r.hD){var n;let t=(null==(n=e.payload)?void 0:n.details)?" — ".concat(e.payload.details):"";return"".concat(e.message).concat(t," (HTTP ").concat(e.status,")")}return(null==e?void 0:e.message)?String(e.message):String(e)}async function j(){c(!0);try{var e;let[n,t]=await Promise.all([(0,r.Vg)("/settings/subscription"),(0,r.Vg)("/auth/me")]);p(n),x(null!=(e=t.workspaceId)?e:""),f("")}catch(e){h(y(e))}finally{c(!1)}}async function b(){d(!0),h(null);try{let e={licenseKey:m.trim()},n=await (0,r.mu)("/settings/subscription",e);p(n),f(""),h("Saved and verified.")}catch(e){h(y(e))}finally{d(!1)}}async function S(){if(confirm("Remove the stored license key? This will disable licensed features until a new key is saved.")){d(!0),h(null);try{let e=await (0,r.Al)("/settings/subscription");p(e),f(""),x(""),h("License removed.")}catch(e){h(y(e))}finally{d(!1)}}}return(0,a.useEffect)(()=>{j()},[]),(0,s.jsxs)("div",{style:{maxWidth:980},children:[(0,s.jsxs)("div",{style:{marginBottom:10,display:"flex",gap:8,flexWrap:"wrap"},children:[(0,s.jsx)(l(),{href:"/settings",className:"btn",children:"← Back to settings"}),(0,s.jsx)(l(),{href:"/",className:"btn",children:"← Back to dashboard"})]}),(0,s.jsx)("h2",{style:{marginTop:0},children:"License Management"}),(0,s.jsxs)("div",{className:"card",style:{padding:12,fontSize:13},children:[(0,s.jsx)("div",{style:{fontWeight:700,marginBottom:6},children:"License status"}),i?(0,s.jsx)("div",{style:{color:"var(--muted)"},children:"Loading..."}):g?(0,s.jsxs)("div",{style:{display:"grid",gap:6},children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("b",{children:"Status:"})," ",null!=(e=g.status)?e:g.configured?"UNKNOWN":"NOT CONFIGURED"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("b",{children:"Valid until:"})," ",null!=(n=g.validUntil)?n:"—"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("b",{children:"Checked at:"})," ",null!=(t=g.checkedAt)?t:"—"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("b",{children:"Source:"})," ",g.source]}),g.error?(0,s.jsxs)("div",{style:{color:"var(--warn)"},children:["Error: ",g.error.code,g.error.status?" (HTTP ".concat(g.error.status,")"):"",g.error.message?" — ".concat(g.error.message):""]}):null,g.limits?(0,s.jsxs)("div",{children:[(0,s.jsx)("b",{children:"Limits:"})," bots ",g.limits.includedBots+g.limits.addOnBots,", ","cex ",g.limits.includedCex+g.limits.addOnCex]}):null,g.usage?(0,s.jsxs)("div",{children:[(0,s.jsx)("b",{children:"Usage:"})," bots ",g.usage.bots,g.limits?" / ".concat(g.limits.includedBots+g.limits.addOnBots):"",", ","cex ",g.usage.cex,g.limits?" / ".concat(g.limits.includedCex+g.limits.addOnCex):""]}):null,g.features?(0,s.jsxs)("div",{children:[(0,s.jsx)("b",{children:"Features:"})," ","priceSupport=".concat(g.features.priceSupport?"on":"off",", "),"priceFollow=".concat(g.features.priceFollow?"on":"off",", "),"ai=".concat(g.features.aiRecommendations?"on":"off",", "),"dexPriceFeed=".concat(g.features.dexPriceFeed?"on":"off")]}):null,g.overrides?(0,s.jsxs)("div",{children:[(0,s.jsx)("b",{children:"Overrides:"})," ","manual=".concat(g.overrides.manual?"on":"off",", "),"unlimited=".concat(g.overrides.unlimited?"on":"off"),g.overrides.note?" — ".concat(g.overrides.note):""]}):null]}):null]}),(0,s.jsxs)("div",{className:"card",style:{padding:12,fontSize:13,marginTop:12},children:[(0,s.jsx)("div",{style:{fontWeight:700,marginBottom:6},children:"License configuration"}),(0,s.jsx)("div",{style:{color:"var(--muted)",marginBottom:10},children:"License changes are picked up automatically by the runner during the next verification cycle."}),(0,s.jsxs)("div",{style:{display:"grid",gap:10,marginBottom:10},children:[(0,s.jsxs)("label",{style:{display:"grid",gap:6},children:[(0,s.jsx)("span",{style:{fontSize:12,color:"var(--muted)"},children:"License key"}),(0,s.jsx)("input",{className:"input",placeholder:(null==g?void 0:g.licenseKeyMasked)?"Current: ".concat(g.licenseKeyMasked):"UUID",value:m,onChange:e=>f(e.target.value)})]}),(0,s.jsxs)("div",{style:{fontSize:12,color:"var(--muted)"},children:["Instance ID is automatically set to your workspace ID:",(0,s.jsx)("span",{style:{marginLeft:6,fontWeight:600},children:v||(null==g?void 0:g.instanceId)||"—"})]})]}),(0,s.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:10},children:[(0,s.jsx)("button",{className:"btn btnPrimary",onClick:b,disabled:o,children:o?"Saving...":"Save & verify"}),(0,s.jsx)("button",{className:"btn",onClick:j,disabled:i,children:"Refresh status"}),(0,s.jsx)("button",{className:"btn btnStop",onClick:S,disabled:o||i,children:"Remove license"})]}),u?(0,s.jsx)("div",{style:{marginTop:10,color:"var(--muted)"},children:u}):null]})]})}}},e=>{e.O(0,[664,587,18,358],()=>e(e.s=6206)),_N_E=e.O()}]);