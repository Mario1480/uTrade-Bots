# UI Internationalization (DE/EN)

## Scope
- Locale-prefixed routes: `/en/...`, `/de/...`
- Runtime locale source of truth: URL prefix
- Persisted user preference: `utrade_locale` cookie
- Fallback locale: `en`

## Architecture
- `next-intl` provides translations in React via `NextIntlClientProvider` and `useTranslations`.
- Middleware resolves/normalizes locale routes and keeps existing auth checks.
- Existing non-localized links keep working through middleware redirects.

## Directory Layout
- `apps/web/i18n/config.ts`: locale constants + routing helpers
- `apps/web/i18n/request.ts`: request-side locale resolver
- `apps/web/i18n/messages.ts`: locale -> namespace bundle mapping
- `apps/web/messages/en/*.json`
- `apps/web/messages/de/*.json`

## Adding New Translation Keys
1. Add key in `apps/web/messages/en/<namespace>.json`.
2. Add matching key in `apps/web/messages/de/<namespace>.json`.
3. Use key via `useTranslations("<namespace>")`.
4. Run integrity check:
   - `npm -w apps/web run i18n:check`

## Rules
- Do not hardcode new UI text in components.
- Use translation keys and namespaces (`common`, `nav`, `auth`, `dashboard`, `system`, ...).
- Keep key names stable once shipped.

## Tests
- Locale helper tests:
  - `npm -w apps/web run test:i18n-routing`
- Translation key integrity:
  - `npm -w apps/web run i18n:check`
